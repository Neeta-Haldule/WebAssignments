function FormHeader(a){this.register();this.init(a)}
(function(){extend(FormHeader,Component,{init:function(a){this.data=a;this.buttonsMetaData={};this.buttonsMetaData[0]={name:"save",group:"button"};this.buttonsMetaData[1]={name:"spellCheck",css:"icspellcheck",group:"validation"};this.buttonsMetaData[2]={name:"pdf",group:"button",autoSave:!0};this.buttonsMetaData[3]={name:"print",group:"button",autoSave:!0};this.buttonsMetaData[4]={name:"delete",css:"icdelete",group:"delete"};this.buttonsMetaData[6]={name:"360",css:"ic360",group:"history"};this.buttonsMetaData[7]=
{name:"performancehistory",css:"ichistory",group:"history",autoSave:!0};this.buttonsMetaData[8]={name:"info",css:"icinfo",group:"misc"};this.buttonsMetaData[18]={name:"legalScan",css:"iclegalscan",group:"validation"};this.buttonsMetaData[21]={name:"calendar",css:"iccalendar",group:"misc",autoSaveIndependent:!0};this.categorizeButtons();this.toolbarLayout=new SFDocumentToolbarLayout({styleClass:"globalPlacematText"});a=[];a.push.apply(a,this._validationsGroup);0<this._validationsGroup.length&&(0<this._miscGroup.length||
0<this._deleteGroup.length)&&(a[a.length-1].css="pmuDropDown pmuDropDownDelimiter");a.push.apply(a,this._miscGroup);0<this._miscGroup.length&&0<this._deleteGroup.length&&(a[a.length-1].css="pmuDropDown pmuDropDownDelimiter");a.push.apply(a,this._deleteGroup);0<a.length&&(this._actionDropMenu=new SFDropMenuPopup(a),this._actionDropMenu.addEventListener("action",this),this._actionButton=new SFToolbarButton({actionCommand:"actions",label:MSGS.COMMON_ACTIONS,iconFontHexCode:"\x26#xe1f2;",iconFontClass:"sapIcon actionsIcon",
isFioriButton:!0,tooltip:MSGS.COMMON_ACTIONS}),this._actionButton.addEventListener("action",this),this._actionDropMenu.setRefocusId(this._actionButton._getFocusId()),this.toolbarLayout.add(this._actionButton));0<this._historyGroup.length&&(this._historyDropMenu=new SFDropMenuPopup(this._historyGroup),this._historyDropMenu.addEventListener("action",this),this._historyButton=new SFToolbarButton({actionCommand:"history",label:MSGS.PERFORMANCE_REVIEW_HISTORY_DROP_DOWN,iconFontHexCode:"\x26#xe02d;",iconFontClass:"sapIcon",
isFioriButton:!0,tooltip:MSGS.PERFORMANCE_REVIEW_HISTORY_DROP_DOWN}),this._historyButton.addEventListener("action",this),this.toolbarLayout.add(this._historyButton));this.loadingIndicator=new SFLoading;a=0;for(var b=this._buttonsGroup.length;a<b;a++)this.buttonsMetaData[this._buttonsGroup[a].data.type]&&this.toolbarLayout.add(this._buttonsGroup[a].button)},categorizeButtons:function(){this._validationsGroup=[];this._deleteGroup=[];this._historyGroup=[];this._buttonsGroup=[];this._miscGroup=[];if(this.data.toolbarbuttons&&
0<this.data.toolbarbuttons.length)for(var a=this.data.toolbarbuttons,b=0,c=a.length;b<c;b++){var e=a[b],f=this.buttonsMetaData[e.type];if(f){var d;if("button"==f.group){switch(f.name){case "save":d={name:"save",button:new SFToolbarButton({actionCommand:"saveAction",iconFontHexCode:"\x26#xe09a;",iconFontClass:"sapIcon",isFioriButton:!0,tooltip:MSGS.COMMON_Save}),data:e};break;case "print":d={name:"print",button:new SFToolbarButton({actionCommand:"printAction",iconFontHexCode:"\x26#xe099;",iconFontClass:"sapIcon",
isFioriButton:!0,tooltip:MSGS.COMMON_Print}),data:e};break;case "pdf":d={name:"pdf",button:new SFToolbarButton({actionCommand:"pdfAction",iconFontHexCode:"\x26#xe01a;",iconFontClass:"sapIcon",isFioriButton:!0,tooltip:MSGS.COMMON_SAVE_AS_PDF}),data:e}}d&&d.button.addEventListener("action",this)}else d={actionCommand:f.name,data:e,label:e.title,css:"pmuDropDown"};switch(f.group){case "button":d.indx=b;this._buttonsGroup.push(d);break;case "validation":this._validationsGroup.push(d);break;case "delete":this._deleteGroup.push(d);
break;case "history":this._historyGroup.push(d);break;default:this._miscGroup.push(d)}}}},renderHtml:function(a){this.data&&(this.data.backLink&&(a.push("\x3cdiv\x3e"),a.push('\x3ca class\x3d"globalPlacematLink" href\x3d"javascript:void(0);" onclick\x3d"',this.data.backLink.onClick,'"\x3e',this.data.backLink.label,"\x3c/a\x3e"),a.push("\x3c/div\x3e")),a.push('\x3ch1 class\x3d"globalPageTitle formHeadTitle"\x3e',this.data.formTitle,"\x3c/h1\x3e"),a.push('\x3cdiv class\x3d" pmuToolbar"\x3e'),this.renderSavingIndicator(a),
this.toolbarLayout.renderHtml(a),a.push("\x3c/div\x3e"),a.push('\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'))},renderSavingIndicator:function(a){a.push('\x3cspan class\x3d"globalPlacematText" id\x3d"pm2SaveIndicator"\x3e');a.push("\x3c/span\x3e")},renderIcon:function(a,b,c,e,f){var d=[];d.push('\x3cspan class\x3d"btn"\x3e');d.push('\x3cspan class\x3d"left"\x3e\x3cspan class\x3d"right"\x3e');d.push('\x3ca class\x3d"icon ',c,'" href\x3d"javascript:void(0);" title\x3d"',e,'" ');d.push('onclick\x3d"',this.fireCode("clickAction",
a,f,b),'"\x3e');d.push('\x3cem class\x3d"label"\x3e\x26nbsp;\x3c/em\x3e');d.push("\x3c/a\x3e");d.push("\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e");return d.join("")},clickButton:function(a){var b=this.data.toolbarbuttons[a].data;a="/printpreview?bplte_company\x3d"+b.companyId+"\x26pp_pm_fmapid\x3d"+b.folderMapId+"\x26pp_pm_mode\x3dpp_pm_mode_setup\x26pp_pm_format\x3d"+(2==this.data.toolbarbuttons[a].type?"pp_pm_format_pdf":"pp_pm_format_html")+"\x26pp_pm_tm\x3d"+b.timeStamp+"\x26pp_pm_tk\x3d"+b.localHash+
"\x26pp_pm_owner\x3d"+b.formOwnerId+"\x26pp_cal_session_id\x3d"+b.calSessionId+"\x26_s.crb\x3d"+ajaxSecKey;a=Util.updateURLNonce(a,"PMPrintPreview");this.openPrintDialog(a)},openPrintWindow:function(a){(a=window.open(a,"printpreview","menubar,scrollbars,toolbar\x3d1,resizable,height\x3d500,outerHeight\x3d735,width\x3d980"))&&a.focus()},openPrintDialog:function(a){this.printPreviewDialog&&this.printPreviewDialog.cleanup();this.printPreviewDialog=new SFDialogBox({title:MSGS.PERFORMANCE_PRINT_DIALOG_TITLE,
buttons:[],content:"\x3ciframe id\x3d'printpreview' tabindex\x3d'0' style\x3d'border:none;' width\x3d'1288px' height\x3d'896px' name\x3d'PrintPreview' src\x3d'"+a+"'\x3e\x3c/iframe\x3e",width:1352,height:1012,scrollable:!1,closeDialogOnEsc:!0});this.printPreviewDialog.showDialog(!0,document.activeElement);jQuery("#printpreview").data("dialogId",this.printPreviewDialog.getReferenceId())},handleEvent:function(a){switch(a.type){case "action":if("saveAction"==a.actionCommand){a=0;for(var b=this._buttonsGroup.length;a<
b;a++){var c=this._buttonsGroup[a].data;if("save"==this._buttonsGroup[a].name){this.clickAction(this.buttonsMetaData[c.type],c.onClick,this._buttonsGroup[a].indx);break}}}else if("printAction"==a.actionCommand)for(a=0,b=this._buttonsGroup.length;a<b;a++){if(c=this._buttonsGroup[a].data,"print"==this._buttonsGroup[a].name){this.clickAction(this.buttonsMetaData[c.type],c.onClick,this._buttonsGroup[a].indx);break}}else if("pdfAction"==a.actionCommand)for(a=0,b=this._buttonsGroup.length;a<b;a++){if(c=
this._buttonsGroup[a].data,"pdf"==this._buttonsGroup[a].name){this.clickAction(this.buttonsMetaData[c.type],c.onClick,this._buttonsGroup[a].indx);break}}else"actions"==a.actionCommand?this._actionDropMenu.show(this._actionButton.id):"history"==a.actionCommand?this._historyDropMenu.show(this._historyButton.id):(a=a.menuItem.data,this.clickAction(this.buttonsMetaData[a.type],a.onClick));break;case "autoSaveComplete":PMUSaveUtils.removeEventListener("autoSaveComplete",this),SFOverlayMgr.removeOverlay(this.loadingIndicator.id),
a.success&&(this._currentClickedButton.onClick?(new Function(this._currentClickedButton.onClick))():this.clickButton(this._currentClickedButton.index))}},clickAction:function(a,b,c){PMUSaveUtils.checkSessionTimeout()||(a&&a.autoSave?(PMUSaveUtils.autoSaveForm(!0),this._currentClickedButton={onClick:b,index:c},PMUSaveUtils.addEventListener("autoSaveComplete",this),SFOverlayMgr.showOverlay(this.loadingIndicator,!0)):b?(PMUSaveUtils.nextSubmitAutoSaveIndependent=a&&!!a.autoSaveIndependent,(new Function(b))()):
this.clickButton(c))}})})();var globalData={summarySectionData:null,objCompSummarySectionData:null};
"undefined"==typeof PMUSaveUtils&&function(){var a=window.formConfig?window.formConfig.autoSaveTimeout:5E3;window.PMUSaveUtils=juic.set(new juic.EventTarget,{init:function(){this.timeoutId=null;this.nextSubmitAutoSaveIndependent=this.triggerNextImmediateAutoSave=this.triggerNextAutoSave=this.formSubmitInProgress=this.autoSaveInProgress=!1;this.loadingIndicator=new SFLoading;this.existingSubmitHandler=null;this.autoSaveErrorMsgMap={};this.autoSaveErrorMsgMap.autoSaveApplicationError=MSGS.PERFORMANCE_PMU_AUTO_SAVE_FAILED;
this.autoSaveErrorMsgMap.autoSaveRequestTimeOut=MSGS.PERFORMANCE_PMU_AUTO_SAVE_FAILED;this.autoSaveErrorMsgMap.autoSaveUnknownError=MSGS.PERFORMANCE_PMU_AUTO_SAVE_FAILED;this.autoSaveErrorMsgMap.autoSaveSessionTimeout=MSGS.PERFORMANCE_PMU_AUTO_SAVE_SESSION_TIMEOUT;window.SFSessionTimeout&&this.addEventListener("sessionTimedOut",window.SFSessionTimeout)},registerFormSubmitListener:function(){this.existingSubmitHandler=document.forms[0].onsubmit;document.forms[0].onsubmit=PMUSaveUtils.submitForm},autoSaveForm:function(b,
c,e){window.setFormModifiedFlagTrue&&setFormModifiedFlagTrue();b=!!b;if(this.autoSaveInProgress)b?(this.triggerNextImmediateAutoSave=!0,this.lastPendingExcuteNext=c,this.lastPendingNextHandler=e):this.triggerNextAutoSave=!0;else{window.clearTimeout(this.timeoutId);var f=this;b?c?this._autoSave(c,e):this._autoSave():this.timeoutId=window.setTimeout(function(){f._autoSave()},a)}},_autoSave:function(a,c){PMUSaveUtils.checkSessionTimeout()||this.formSubmitInProgress||(juic.$("pm2SaveIndicator").innerHTML=
"\x3cspan role\x3d'status' aria-live\x3d'polite'\x3e"+MSGS.COMMON_SAVING+"\x3c/span\x3e",a?this.submitFormUsingAjax(this,this.onCompleteHandler,a,c):this.submitFormUsingAjax(this,this.onCompleteHandler),this.autoSaveInProgress=!0)},onCompleteHandler:function(a,c){juic.$("pm2SaveIndicator").innerHTML=a?"\x3cspan role\x3d'status' aria-live\x3d'polite'\x3e"+MSGS.COMMON_CHANGES_SAVED+"\x3c/span\x3e":"\x3cspan role\x3d'alert' class\x3d'highlight'\x3e"+this.autoSaveErrorMsgMap[c]+"\x3c/span\x3e";if(a)window.SFSessionTimeout&&
window.SFSessionTimeout.setSessionTimedOutAddonMsg(MSGS.PERFORMANCE_PMU_AUTO_SAVE_SESSION_TIMEOUT_SAVED),this.bindSavedIndicateEvent();else if("autoSaveSessionTimeout"==c){window.SFSessionTimeout&&(window.SFSessionTimeout.setSessionTimedOutAddonMsg(this.autoSaveErrorMsgMap[c]),this.dispatch("sessionTimedOut"));return}this.autoSaveInProgress=!1;this.triggerNextImmediateAutoSave?(this.triggerNextImmediateAutoSave=!1,this.triggerNextAutoSave&&(this.triggerNextAutoSave=!1),this.autoSaveForm(!0,this.lastPendingExcuteNext,
this.lastPendingNextHandler)):this.dispatch("autoSaveComplete",{success:a});this.triggerNextAutoSave&&(this.triggerNextAutoSave=!1,this.autoSaveForm())},bindSavedIndicateEvent:function(){var a=this;null==this._anyUserActionHandle&&(this._anyUserActionHandle=function(){a.unbindSavedIndicateEvent();a._anyUserActionTimeout||(a._anyUserActionTimeout=setTimeout(function(){delete a._anyUserActionTimeout;var b=jQuery("#pm2SaveIndicator");b&&(window.SFSessionTimeout&&window.SFSessionTimeout.setSessionTimedOutAddonMsg(""),
b.fadeOut(1E3,function(){b.html("");b.css("display","")}))},800))},jQuery("body").on("click keydown",this._anyUserActionHandle),jQuery(window).on("scroll",this._anyUserActionHandle))},unbindSavedIndicateEvent:function(){this._anyUserActionTimeout&&clearTimeout(this._anyUserActionTimeout);jQuery("body").off("click focusin keydown",this._anyUserActionHandle);jQuery(window).off("scroll",this._anyUserActionHandle);delete this._anyUserActionHandle},submitForm:function(a){PMUSaveUtils.checkSessionTimeout()||
(PMUSaveUtils.nextSubmitAutoSaveIndependent?(PMUSaveUtils.existingSubmitHandler&&PMUSaveUtils.existingSubmitHandler(),PMUSaveUtils.nextSubmitAutoSaveIndependent=!1):(SFOverlayMgr.hasOverlay(PMUSaveUtils.loadingIndicator)||SFOverlayMgr.showOverlay(PMUSaveUtils.loadingIndicator,!0),PMUSaveUtils.autoSaveInProgress?(a&&SFDOMEvent.preventDefault(a),window.setTimeout(PMUSaveUtils.submitForm,1E3)):(window.setFormModifiedFlagTrue&&setFormModifiedFlagTrue(),PMUSaveUtils.existingSubmitHandler&&PMUSaveUtils.existingSubmitHandler(),
PMUSaveUtils.formSubmitInProgress=!0,void 0==a&&juic.$(formSubmitButtonId).click())))},submitFormUsingAjax:function(a,c,e,f){var b=document.forms[0];b&&(window.setFormModifiedFlagTrue&&setFormModifiedFlagTrue(),jQuery.ajax({type:"POST",url:b.action,data:jQuery("#"+b.id).serialize(),timeout:12E4,beforeSend:function(a,c){if(e){for(var d=jQuery("#"+b.id).serializeArray(),h=0;h<d.length;++h)if("fb2rte_option"==d[h].name){d[h].value="_get_feedback";break}c.data=jQuery.param(d)}},dataFilter:function(a){if(e)if(0<=
a.indexOf('\x3cdiv id\x3d"validaiton-error"\x3e')){e=!1;var b=decodeURIComponent(a.match(/<div id=\"validaiton-error\">(.*?)<\/div>/g)[0].replace(/(<([^>]+)>)/ig,"").replace(/\\n/g,"\n").replace(/\\'/g,"'"));alert(b)}else 0<=a.indexOf('\x3cdiv id\x3d"validaiton-warn"\x3e')&&(b=decodeURIComponent(a.match(/<div id=\"validaiton-warn\">(.*?)<\/div>/g)[0].replace(/(<([^>]+)>)/ig,"").replace(/\\n/g,"\n").replace(/\\'/g,"'")),confirm(b)||(e=!1));return a},success:function(b,d,g){b=!1;g&&200==g.status&&g.responseText&&
0>g.responseText.indexOf('name\x3d"loginForm"')&&0<g.responseText.indexOf('name\x3d"myf_os"')&&(b=!0);b?(jQuery(g.responseText).find('script[type\x3d"text/javascript"]:contains("formData[")').each(function(){var a=this.text||this.textContent||this.innerHTML||"";if(-1!=a.indexOf('sectType:"SUMMARY"')||-1!=a.indexOf('sectType:"OBJCOMPSUMMARY"')){var b=a.replace("\x3c!--",""),a=b.substring(0,b.lastIndexOf("//--\x3e")),b=a.substring(0,a.lastIndexOf("};"))+"}",b=JSON.stringify(eval("("+b+")"));-1!=a.indexOf('sectType:"SUMMARY"')?
globalData.summarySectionData=JSON.parse(b):globalData.objCompSummarySectionData=JSON.parse(b)}}),window.SFSessionTimeout&&window.SFSessionTimeout.reset(),window.setFormModifiedFlagWithValue&&setFormModifiedFlagWithValue(!1),c.call(a,!0),e&&f.call()):g&&0<g.responseText.indexOf('name\x3d"loginForm"')?c.call(a,!1,"autoSaveSessionTimeout"):(window.SFSessionTimeout&&window.SFSessionTimeout.reset(),c.call(a,!1,"autoSaveApplicationError"))},error:function(b,d,e){"timeout"==d?(window.SFSessionTimeout&&
window.SFSessionTimeout.reset(),c.call(a,!1,"autoSaveRequestTimeOut")):c.call(a,!1,"autoSaveUnknownError")}}))},checkSessionTimeout:function(){if(window.SFSessionTimeout&&window.SFSessionTimeout.isSessionExpired()){if(window.SFSessionTimeout._sessionExpiredDialog){var a;(a=window.SFSessionTimeout._sessionExpiredDialog.getContent?window.SFSessionTimeout._sessionExpiredDialog.getContent():window.SFSessionTimeout._sessionExpiredDialog._contentComponent)&&a.setAddonMsg&&a.setAddonMsg(MSGS.PERFORMANCE_PMU_AUTO_SAVE_SESSION_TIMEOUT)}this.dispatch("sessionTimedOut");
return!0}return!1}});window.PMUSaveUtils.init();window.addEventListener("beforeunload",function(a){!window.PMUSaveUtils.formSubmitInProgress&&getFormModifiedFlagValue()&&(window.PMUSaveUtils._autoSave(),a.preventDefault(),a.returnValue="")})}();