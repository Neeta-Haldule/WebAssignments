function normalizeRouteData(a){var c;for(prop in a)if("routeMapStageList"===prop&&(a.stepsChartStageList=a[prop],delete a[prop],a.stepsChartStageList))for(c=0;c<a.stepsChartStageList.length;c++){a.stepsChartStageList[c].stepsChartStepVOList=a.stepsChartStageList[c].routeStepVOList;delete a.stepsChartStageList[c].routeStepVOList;for(var b=a.stepsChartStageList[c].stepsChartStepVOList,d=0;d<b.length;d++){var e=b[d],f=!1;if(e.icSubStepVOList)for(var g=0;g<e.icSubStepVOList.length&&!(f=e.icSubStepVOList[g],
f=!(!f.userFullName&&!f.userRole));g++);e.showInfoIcon=!!(e.description||e.userFullName||e.userRole||f)}}return a}function SFRouteMap(a){this.register();a=normalizeRouteData(a);juic.assert(a,"SFRouteMap - incorrect data provided");this._init(a)}
(function(){juic.extend(SFRouteMap,SFStepsChart,{_init:function(a){this.addEventListener("stepInfoClick",this,"handleInfoClick");this._super(a)},handleInfoClick:function(a){switch(a.type){case "stepInfoClick":this._showInfo(a)}},_getInfoContent:function(a){var c=new SFContainer,b=new SFContainer,d=a.step.userFullName,e=a.step.userRole;if(d||e)d&&(d=new SFText(d),d.setCSSClass("sfStepsChartHighlight"),b.setStyleClass("sfStepsChartStepOwner"),b.add(d)),e&&b.add(new SFText("("+e+")")),c.add(b);a.step.description&&
(b=new SFText(a.step.description),b.setCSSClass("sfStepsChartInfoDescription"),c.add(b));if(b=a.step.icSubStepVOList)for(a=0;a<b.length;a++)d=b[a],d.userFullName&&c.add(new SFText(d.userFullName));return c},_showInfo:function(a){this._infoPopup=new SFCalloutPopup({content:this._getInfoContent(a),width:200,closeDialogOnEsc:!0,useNameAnchor:!0,showCloseIcon:!1,clickOutsideClosesPopup:!0,closeOnMouseout:!1,refocusRef:juic.$(a.infoId),role:"dialog",originOptions:{direction:"bottom",pointerOffset:100}});
this._infoPopup.show(a.infoId);this._infoPopup.setFocus(!0)}})})();function SFRouteMapContainer(a){this.register();this._init(a)}
(function(){juic.extend(SFRouteMapContainer,juic.Component,{_init:function(a){this._data=a;this._data.showInfoIcon=!0;this._routeMap=new SFRouteMap(this._data);this._routeMap.addEventListener("stepInfoClick",this);this._carousel=new SFCarousel({content:this._routeMap,stepDistance:300});this._routeMapHeader=new SFRouteMapHeader;this._routeMapHeader.addEventListener("showRouteMap",this);this._portlet=new RouteMapPortlet(this._carousel,!1,this._routeMapHeader,!0);this._portlet.setCssClass("globalPortletBody routeMapPortlet");
this._routeMap.addEventListener("menuItemClicked",this);this._routeMap.addEventListener("adjustDOMComplete",this)},handleAdjustDom:function(){this._slideToCurrentStep()},getSectionTitle:function(){return MSGS.PERFORMANCE_ROUTEMAP_HEADER},getFocusId:function(){return"routeMap"},renderHtml:function(a){this._portlet.renderHtml(a)},_slideToCurrentStep:function(){var a=this,c,b,d,e,f=juic.$("sfCarouselContent"+a._carousel.id).clientWidth||1E4;setTimeout(function(){(c=a._routeMap.getCurrentStep())&&0<c.getStepOrder()&&
(d=(b=juic.$(c.getDomId()))?b.parentNode.scrollWidth:0,e=b?b.offsetLeft:0,0<e&&e+d>f&&(a._carousel._resetContentPosition(),a._carousel.slideCarousel(e)))},100)},handleEvent:function(a){switch(a.type){case "showRouteMap":this.showRouteMap(a.showRouteMap);break;case "stepInfoClick":this.dispatchEvent(a);break;case "adjustDOMComplete":this.handleAdjustDom();break;default:this.dispatchEvent(a)}},showRouteMap:function(a){this._routeMap.showStepsChart(a);this._carousel.showArrowButtons(a)}})})();
function SFRouteMapHeader(){this.register();this._showRouteMap=!0}
(function(){juic.extend(SFRouteMapHeader,juic.Component,{renderHtml:function(a){a.push('\x3cdiv class\x3d"sfRouteMapTopbar"\x3e');a.push('\x3cdiv class\x3d"sfRouteMapHideShowContainer addItemLink"\x3e');a.push('\x3cdiv class\x3d"addItemLinkText"\x3e');a.push('\x3ca id\x3d"',this.id,'_showHideLink" href\x3d"javascript: void(0)"" onclick\x3d"',this.fireCode("_showRouteMapClicked"),'" ');a.push('class\x3d"globalPlacematLink sfRouteMapToggle ',"sfRouteMapHide",'" title\x3d"',MSGS.COMMON_Hide,'"\x3e\x3c/a\x3e');
a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push('\x3cdiv class\x3d"sfRouteMapTitleBar"\x3e');a.push('\x3ch3 id\x3d"',this.id,'_sectTitle" title\x3d"',MSGS.PERFORMANCE_ROUTEMAP_HEADER,'"\x3e',MSGS.PERFORMANCE_ROUTEMAP_HEADER,"\x3c/h3\x3e");a.push("\x3c/div\x3e");a.push("\x3c/div\x3e")},_showRouteMapClicked:function(){var a=juic.$(this.id+"_showHideLink");(this._showRouteMap=!this._showRouteMap)?(Util.removeClass(a,"sfRouteMapShow"),Util.addClass(a,"sfRouteMapHide"),a.title=MSGS.COMMON_Hide):(Util.removeClass(a,
"sfRouteMapHide"),Util.addClass(a,"sfRouteMapShow"),a.title=MSGS.COMMON_Show);this.dispatch("showRouteMap",{showRouteMap:this._showRouteMap})}})})();