function CustomSection(a,c){this.register();this.init(a,c)}
(function(){extend(CustomSection,PM2BaseSection,{init:function(a,c){this.m=a;this.dataPath=c;this.sectionData=this.m.getData(this.dataPath);var b=new CustomSectionContent(this.m,this.dataPath);this.itemPortlet=new PMPortlet(b,this.sectionData.sectName,!0);if(this.sectionData.hasSectionComment){var b=this.sectionData.sectComment,d=this.sectionData.othersSectComments;if(b&&b.commentsPerm&&("write"==b.commentsPerm.name||"read"==b.commentsPerm.name)||d&&0<d.length)b=new PM2SectionOverallComment(this.m,
this.dataPath),this.overallCommentPortlet=new PMPortlet(b)}},renderHtml:function(a){a.push('\x3ca href\x3d"#" class\x3d"anchor_rel" id\x3d"anchor_',this.sectionData.sectIndex,'" name\x3d"anchor_',this.sectionData.sectIndex,'" title\x3d"',juic.escapeHTML(this.sectionData.sectName),'" aria-hidden\x3d"true" \x3e\x26nbsp;\x3c/a\x3e');this.itemPortlet.renderHtml(a);this.overallCommentPortlet&&this.overallCommentPortlet.renderHtml(a)},getSectionTitle:function(){return this.sectionData.sectName},getFocusId:function(){return this.itemPortlet.getFocussableAnchor()}})})();
function CustomSectionContent(a,c){this.register();this.init(a,c)}
(function(){extend(CustomSectionContent,Component,{init:function(a,c){this.m=a;this.dataPath=c;this.sectionData=this.m.getData(this.dataPath);this.sectionData.sectDesc&&(this.sectionCaption=""!==this.sectionData.sectDesc.trim()?new PM2SectionCaption(this.m,this.dataPath):null);this.comp=new PMCustom(a,this.dataPath+"/elements",{spellCheck:this.sectionData.spellCheck,legalScan:this.sectionData.legalScan})},renderHtml:function(a){this.sectionCaption&&this.sectionCaption.renderHtml(a);a.push('\x3cdiv class\x3d"pmCustom"\x3e');
this.comp.renderHtml(a);a.push("\x3c/dvi\x3e")}})})();function PMCustom(a,c,b){this.register();this._init(a,c,b)}
PMCustom.prototype=function(){return set(new PM2BaseSection,{_init:function(a,c,b){this.m=a;this.dataPath=c;this._customElementVOs=this.m.getData(this.dataPath);this._spellCheck=b?b.spellCheck:!1;this._legalScan=b?b.legalScan:!1;this._waca=b?b.waca:!1;this._twoColumnsLayout=b?b.twoColumnsLayout:!1;this._captureOnClickEvent=b?b.captureOnClickEvent:!1;this._accessmap={};this.layoutFields()},_genElementMap:function(a,c){this._accessmap[a]=c},_getElementIndexByName:function(a){return this._accessmap[a]},
_bindValidation:function(a,c){var b=c.type;PMValidationUtil.bindTypeValidator(PMTypeUtil.TYPE_VALIDATION_MAP[b],a);c.required&&PMValidationUtil.bindRequiredValidator(a);var d=c.min,e=c.max;-1==d&&-1==e||d==e||0==e||(b==PMTypeUtil.TYPE_INTEGER||b==PMTypeUtil.TYPE_DOUBLE?PMValidationUtil.bindValueValidator(a,d,e):b!=PMTypeUtil.TYPE_TEXT&&b!=PMTypeUtil.TYPE_TEXTAREA||PMValidationUtil.bindLengthValidator(a,d,e))},processFields:function(a){var c,b,d=!a.editable,e=a.required;c=d?"":"lbspace";switch(a.type){case PMTypeUtil.TYPE_LABEL:c=
PMFormInputFactory.genLabel(a.name,"",{required:e});break;case PMTypeUtil.TYPE_TEXT:case PMTypeUtil.TYPE_INTEGER:case PMTypeUtil.TYPE_DOUBLE:b={readonly:d,type:"text"};a.type==PMTypeUtil.TYPE_TEXT&&a.textSize&&0<a.textSize&&(b.size=a.textSize);b=new PMInputEle(a.name,a.key,a.value,"input",b);b=PMFormInputFactory.genInputCtrl(b);d||a.type!=PMTypeUtil.TYPE_TEXT||(window[a.key]=b,window[b.getInputDomId()]=b);c=PMFormInputFactory.genLabel(a.name,d?"":b.getInputDomId(),{required:e,cssClass:c});break;case PMTypeUtil.TYPE_TEXTAREA:c=
this._waca&&a.showWaca;b=this.dataPath.split("/");b=this.m.getData((b[0]?"/"+b[0]:"/"+b[1])+"/sectionCommentsMaxLimit");a.required&&(b=a.max);if(b)if(0<b&&100>b)b=100;else{if(4E3<b||0>=b)b=4E3}else b=-1;b=new PMInputEle(a.name,a.key,a.value,"RTE",{readonly:d,spellCheck:this._spellCheck,legalScan:this._legalScan,waca:c,maxChars:b});b=PMFormInputFactory.genInputCtrl(b);d||(window[a.key]=b);c&&b.addEventListener("openWritingAssistant",this);c=PMFormInputFactory.genLabel(a.name,b instanceof PMTextArea?
b.getContentId():b.id,{required:e});break;case PMTypeUtil.TYPE_DATE:b=new PMInputEle(a.name,a.key,a.value,"date",{readonly:d});b=PMFormInputFactory.genInputCtrl(b);c=PMFormInputFactory.genLabel(a.name,d?"":b.getInputDomId(),{required:e,cssClass:c});break;case PMTypeUtil.TYPE_LIST:b=[];for(var g=void 0,f=0;f<a.elementList.length;f++){var h=new SFSimpleSelectItem(a.elementList[f].value,a.elementList[f].name);a.elementList[f].selected&&(g=a.elementList[f].value);b.push(h)}b=new PMInputEle(a.name,a.key,
g,"selector",{readonly:d,items:b});b=PMFormInputFactory.genInputCtrl(b);c=PMFormInputFactory.genLabel(a.name,d?"":b.getInputDomId(),{required:e,cssClass:c});break;case PMTypeUtil.TYPE_CHECKBOX:b=new PMInputEle(a.name,a.key,a.value,"input",{readonly:d,type:"checkbox",checked:a.checked,required:e});b=PMFormInputFactory.genInputCtrl(b);c=PMFormInputFactory.genLabel(" ","",{required:!1});break;case PMTypeUtil.TYPE_HIDDEN:b=new PMInputEle(a.itemName,a.key,a.value,"input",{type:"hidden"});b=PMFormInputFactory.genInputCtrl(b);
c=PMFormInputFactory.genLabel(a.itemName,b.id,{required:e});c.setClass("invisiable");break;default:return null}b&&!d&&(b.addEventListener("change",this),b.addEventListener("blur",this),this._bindValidation(b,a));return{label:c,inputCtrl:b,required:e,readonly:d}},layoutFields:function(){if(this._customElementVOs&&0<this._customElementVOs.length){for(var a=0,c=[],b=[],d=0,e=this._customElementVOs.length;d<e;d++){var g=this._customElementVOs[d],f=this.processFields(g);null!=f&&(!f.inputCtrl||!f.inputCtrl.bindProperty||
void 0!=f.inputCtrl.isReadOnly&&f.inputCtrl.isReadOnly()||f.inputCtrl.bindProperty(this.m,this.dataPath+"/"+d+"/value"),this._genElementMap(g.key,d),a++,this._twoColumnsLayout?0==a%2?b.push(f):(b=[],b.push(f),c.push(b)):(b=[],b.push(f),c.push(b)))}this.layoutedFields=new PMTableLayout(this._twoColumnsLayout?2:1,c.length,c,"")}},validCustomEle:function(a){this._getElementIndexByName(a.target.name);a.target.getValue();var c=PMValidationUtil.validate(a.target);c.result?(this.layoutedFields.clearFieldError(a.target.id),
PMUSaveUtils.autoSaveForm()):this.layoutedFields.insertFieldError(a.target.id,c.message)},handleEvent:function(a){switch(a.type){case "blur":this.validCustomEle(a);break;case "change":this.validCustomEle(a);break;case "openWritingAssistant":this.dispatch("openWritingAssistant",{customIndex:this._getElementIndexByName(a.name),buttonId:a.buttonId})}},renderHtml:function(a){a.push('\x3cdiv class\x3d"pmContainer"\x3e');a.push('\x3cdiv class\x3d"" style\x3d"float:left;width:100%;"\x3e');a.push('\x3cdiv class\x3d"customelements" ');
this._captureOnClickEvent&&a.push('onclick\x3d"',this.fireCode("_handleClick"),'"');a.push("\x3e");this.layoutedFields&&this.layoutedFields.renderHtml(a);a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push("\x3c/div\x3e")},_handleClick:function(a){var c=a.target||a.srcElement,b=!0,d=c.nodeName||c.tagName,d=d.toUpperCase();"TD"==d?b=!1:"DIV"==d&&(c=c.parentNode,b="TD"!=(c.nodeName||c.tagName).toUpperCase());b&&(null!=a.cancelBubble&&(a.cancelBubble=!0),a.stopPropagation&&a.stopPropagation())}})}();