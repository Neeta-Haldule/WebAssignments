function PMRouteMapPortlet(a){this.register();this._init(a)}
(function(){juic.extend(PMRouteMapPortlet,juic.Component,{_init:function(a){this._data=a;this._routeMap=new SFRouteMap(this._data);this._routeMap.removeEventListener("stepInfoClick",this._routeMap);this._routeMap.addEventListener("stepInfoClick",this);this._routeMap.addEventListener("menuItemClicked",this);this._routeMap.addEventListener("adjustDOMComplete",this);this._carousel=new SFCarousel({content:this._routeMap,stepDistance:300});this._routeMapHeader=new PMRouteMapHeader;this._routeMapHeader.addEventListener("showRouteMap",
this);this._portlet=new PMPortlet(this._carousel,this._routeMapHeader);this._portlet.addCssClass("routeMapPortlet")},handleAdjustDom:function(){this._slideToCurrentStep()},getSectionTitle:function(){return MSGS.PERFORMANCE_ROUTEMAP_HEADER},getFocusId:function(){return"routeMap"},renderHtml:function(a){this._portlet.renderHtml(a)},_slideToCurrentStep:function(){var a=this,d,e,b,c,f=juic.$("sfCarouselContent"+a._carousel.id).clientWidth||1E4;setTimeout(function(){(d=a._routeMap.getCurrentStep())&&0<
d.getStepOrder()&&(e=juic.$(d.getDomId()),b=e.parentNode.scrollWidth,c=e.offsetLeft,0<c&&c+b>f&&(a._carousel._resetContentPosition(),a._carousel.slideCarousel(c)))},500)},handleEvent:function(a){switch(a.type){case "showRouteMap":this._routeMap.showStepsChart(a.showRouteMap);this._carousel.showArrowButtons(a.showRouteMap);break;case "stepInfoClick":this._showInfo(a);break;case "adjustDOMComplete":this.handleAdjustDom();break;default:this.dispatchEvent(a)}},_getInfoContent:function(a){var d=new SFContainer,
e=new SFContainer,b=a.step.userFullName,c=a.step.userRole,f;if(f=a.step.dueDate)f=new SFText(MSGS.PERFORMANCE_ROUTEMAP_DUE_ON.replace("{0}",f)),a.step.overDue?f.setCSSClass("sfStepsChartDueDate calloutDueDate globalPortletAlertTextColor"):f.setCSSClass("sfStepsChartDueDate calloutDueDate"),d.add(f);if(b||c)b&&(b=new SFText(b),b.setCSSClass("sfStepsChartHighlight"),e.setStyleClass("sfStepsChartStepOwner"),e.add(b)),c&&e.add(new SFText("("+c+")")),d.add(e);a.step.description&&(b=new SFText(a.step.description),
b.setCSSClass("sfStepsChartInfoDescription"),d.add(b));if(f=a.step.icSubStepVOList){for(a=0;a<f.length;a++)c=f[a],b=c.userFullName,c=c.userRole,b&&(b=new SFText(b),b.setCSSClass("sfStepsChartHighlight"),e.setStyleClass("sfStepsChartStepOwner"),e.add(b)),c&&e.add(new SFText("("+c+")"));d.add(e)}return d},_showInfo:function(a){this._infoPopup=new SFCalloutPopup({content:this._getInfoContent(a),width:200,closeDialogOnEsc:!0,useNameAnchor:!0,showCloseIcon:!1,clickOutsideClosesPopup:!0,closeOnMouseout:!1,
refocusRef:juic.$(a.infoId),role:"dialog",originOptions:{direction:"bottom",pointerOffset:100}});this._infoPopup.show(a.infoId);this._infoPopup.setFocus()}})})();function PMRouteMapHeader(){this.register();this._showRouteMap=!0}
(function(){juic.extend(PMRouteMapHeader,juic.Component,{renderHtml:function(a){a.push("\x3cdiv class\x3d'pm2SectionTopbar'\x3e");a.push("\x3cdiv class\x3d'leftpart'\x3e");a.push("\x3ch2 id\x3d'",this.id,"_sectTitle' title\x3d'",MSGS.PERFORMANCE_ROUTEMAP_HEADER,"'\x3e",MSGS.PERFORMANCE_ROUTEMAP_HEADER,"\x3c/h2\x3e");a.push("\x3c/div\x3e");a.push("\x3cdiv class\x3d'addItemLink'\x3e");a.push("\x3cdiv class\x3d'addItemLinkText'\x3e");a.push("\x3ca id\x3d'",this.id,"_showHideLink' href\x3d'javascript: void(0)' onclick\x3d'",
this.fireCode("_showRouteMapClicked"),"'"," onkeypress\x3d'",this.fireCode("_showRouteMapKeyPress"),"'"," class\x3d'globalPlacematLink' title\x3d'",MSGS.COMMON_Hide,"' aria-expanded\x3d'true'\x3e",MSGS.COMMON_Hide,"\x3c/a\x3e");a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push("\x3cdiv class\x3d'clear'\x3e\x3c/div\x3e");a.push("\x3c/div\x3e")},_showRouteMapKeyPress:function(a){a.preventDefault();var d=SFDOMEvent.getCharCode(a);d!=SFDOMEvent.KEY_CODE.SPACE&&d!=SFDOMEvent.KEY_CODE.RETURN||this._showRouteMapClicked(a)},
_showRouteMapClicked:function(a){this._showRouteMap=!this._showRouteMap;juic.$(this.id+"_showHideLink").innerHTML=juic.$(this.id+"_showHideLink").title=this._showRouteMap?MSGS.COMMON_Hide:MSGS.COMMON_Show;SFDom.toggleAriaAttribute(juic.$(this.id+"_showHideLink"),"aria-expanded");this.dispatch("showRouteMap",{showRouteMap:this._showRouteMap})}})})();