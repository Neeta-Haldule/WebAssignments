var EVT_LMS_FIND_IN_CATALOG_FINISHED="FIND_IN_CATALOG_FINISHED",EVT_LMS_AJAX_START="AJAX_START",EVT_LMS_AJAX_END="AJAX_END",EVT_LMS_ERROR_MESSAGE="ErrorMessageEvent",EVT_DELETE_LA_FROM_OBJ_DONE="DELETE_LA_FROM_OBJ",EVT_GET_MORE_DETAIL_DONE="GET_MORE_DETAIL_DONE",EVT_GET_DEEP_LINK_DONE="GET_DEEPLINK_OK";
function ActivityIntegrationTable(a,b,c,e,d,h,f,g,k,m,l,n,p,q){this.register();this._dao=a;this._objId=c;this._planType=f;this._isEditable=e;this._goalCompleted=d;this._printMode=h;this._useV12Style=p;this._hasCompetencies=g;this._hasLearningAccess=k;this._formSubjId=m;this._proxyUserFullName=l;this._loginUserId=n;this._goalName=q;this.model=new ActivityIntegrationModel(a,f,l);this.model.addEventListener(EVT_LMS_FIND_IN_CATALOG_FINISHED,this);this.model.addEventListener(EVT_LMS_AJAX_START,this);this.model.addEventListener(EVT_LMS_AJAX_END,
this);this.model.addEventListener(EVT_LMS_ERROR_MESSAGE,this);this.model.addEventListener(EVT_DELETE_LA_FROM_OBJ_DONE,this);this.model.addEventListener(EVT_GET_MORE_DETAIL_DONE,this);this.model.addEventListener(EVT_GET_DEEP_LINK_DONE,this);this.model.addEventListener("action",this);this.initData(b)}
ActivityIntegrationTable.prototype=function(){return set(new Component,{initData:function(a){this._data=a.data;this._meta=a.meta;this._layout=a.planLayout;this._layoutTemplate=a.planLayoutTemplate;this._permission=a.permission;this._selectedUserId=a.selectedUserId;this.manualAddEnabled=!0;if(a.manualAddEnabled||0==a.manualAddEnabled)this.manualAddEnabled=a.manualAddEnabled;4==this._planType&&(this.manualAddEnabled=!1);this.isPlateauEnabled=void 0!=a.plateauEnabled?a.plateauEnabled:!1;this.deepLinkEnable=
!1;a.deepLinkEnable&&(this.deepLinkEnable=!0);this.dataHasDeeplink=!1;this._rowSpan=1;this._addNewContextMenu=null},renderHtml:function(a){a.push("\x3cdiv id\x3d'"+this.id+"'\x3e");this._renderView(a);a.push("\x3c/div\x3e")},updateView:function(){var a=[];this._renderView(a);$(this.id).innerHTML=a.join("")},_renderView:function(a){var b="undefined"!=typeof isRequireTranscriptLearningConsistency&&("true"==isRequireTranscriptLearningConsistency||1==isRequireTranscriptLearningConsistency);b&&this._createAddButtonConsistency(a);
if(this._data&&0<this._data.length){var c=[];layoutArray=this._layoutTemplate;fieldReg=/#[^#]+#/i;for(var e=0;e<this._data.length;e++)for(var d=this._data[e],h=0;h<layoutArray.length;h++)if(content=layoutArray[h],fieldReg.test(content)){var f=content.replace(/#/g,"");if("name"==f)this._isEditable?(b?(c.push("\x3cspan\x3e",Util.escapeHTML(d[f]),"\x3c/span\x3e"),linkName=this.isPlateauEnabled&&d.isFromCatalog?new SFLink("\x3cspan class\x3d'uiConsistencyIcon'\x3e\x26#xe202;\x3c/span\x3e",{outerCss:"uiConsistencyLinkOut",
skipEscaping:!0,onClick:"action",clickParam:{actionCommand:"getMoreDetails",id:d.id,selectedUserId:d.assignee}}):new SFLink("\x3cspan class\x3d'uiConsistencyIcon'\x3e\x26#xe038;\x3c/span\x3e",{outerCss:"uiConsistencyLinkOut",skipEscaping:!0,onClick:"action",clickParam:{actionCommand:"editActivity",activityId:d.id}})):linkName=this.isPlateauEnabled&&d.isFromCatalog?new SFLink(d[f],{onClick:"action",clickParam:{actionCommand:"getMoreDetails",id:d.id,selectedUserId:d.assignee}}):new SFLink(d[f],{onClick:"action",
clickParam:{actionCommand:"editActivity",activityId:d.id}}),linkName.addEventListener("action",this),linkName.renderHtml(c)):c.push(Util.escapeHTML(d[f]));else if("SF_ACTION_SYS"==f)if(b){var g=[];!this._printMode&&this._isEditable&&this._isAllowDelete(d)&&(f={},f.label=MSGS.DEVELOPMENT_TRANSCRIPT_DELETE,f.disabled=!1,f.actionCommand="delete",f.dataid=d.id,f.isFromCatalog=d.isFromCatalog,g.push(f));!this._printMode&&this.deepLinkEnable&&d.isFromCatalog&&this._loginUserId==d.assignee&&(f={},f.label=
MSGS.DEVELOPMENT_TRANSCRIPT_LABEL_DEEPLINK,f.disabled=!1,f.actionCommand="deeplink",f.dataid=d.id,f.planType=this._planType,g.push(f),this.dataHasDeeplink=!0);g&&0<g.length&&(g=new SFDropMenu(g,{content:'\x3cdiv class\x3d"globalIconFont1Support"\x3e\x3cspan class\x3d"tgm-objective-action-icon uiConsistencyIcon" data-icon\x3d""\x3e\x26#xe1f2;\x3c/span\x3e\x3c/div\x3e',title:MSGS.GOALS_V12_ACTIONS_BUTTON_GROUP_NAME,css:"tgm-objective-actions",activeCss:"tgm-objective-action-act",popupCss:"tgm-objective-actions-pop menuDefault"}),
g.addEventListener("action",this),g.renderHtml(c))}else!this._printMode&&this._isEditable&&this._isAllowDelete(d)&&(c.push("\x3cdiv tabIndex\x3d'0' role\x3d'buttons' class\x3d\"cdpItgDeleteLA\" title\x3d\""+MSGS.DEVELOPMENT_TRANSCRIPT_DELETE+'"'),c.push(' onclick\x3d"'+this.fireCode("_deleteClick",d.id,d.isFromCatalog,this._formSubjId)+'" '),c.push("\x3e\x3cspan class\x3d'hiddenAriaContent'\x3e",MSGS.DEVELOPMENT_TRANSCRIPT_DELETE,"\x3c/span\x3e\x3c/div\x3e")),!this._printMode&&this.deepLinkEnable&&
d.isFromCatalog&&this._loginUserId==d.assignee&&(c.push("\x3cdiv tabIndex\x3d'0' role\x3d'buttons' class\x3d\"cdpItgDeepLink\" title\x3d\""+MSGS.DEVELOPMENT_TRANSCRIPT_LABEL_DEEPLINK+'"'),c.push(' onclick\x3d"'+this.fireCode("_deeplinkClick",d.id,this._planType)+'" '),c.push("\x3e\x3cspan class\x3d'hiddenAriaContent'\x3e",MSGS.DEVELOPMENT_TRANSCRIPT_LABEL_DEEPLINK,"\x3c/span\x3e\x3c/div\x3e"),this.dataHasDeeplink=!0);else if(g=this._getMetaByFieldId(f),void 0==d[f]||0==d[f].length)c.push("\x26#160;");
else if(g&&"date"==g.type){var k=new DateFormat("yyyy-MM-dd"),g=new DateFormat(MSGS.COMMON_DateFormat),f=k.parse(d[f]),g=g.format(f);c.push(g)}else g&&"enum"==g.type?c.push(this._getLabelByValue(d[f],g.values)):c.push(Util.escapeHTML(d[f]))}else c.push(content);d=this._useV12Style?"tgm-goal-sub-table":"";d=1==b?d+" activityUIConsistency":d;e=this._useV12Style?"tgm-goal-sub-table-header learning-table-header":"cdpItgLAHeader";h=this._useV12Style?6:3;g=juic.escapeHTML(this._goalName);a.push("\x3ctable summary\x3d'",
sfMessageFormat.format(MSGS.DEVELOPMENT_TRANSCRIPT_LEARNING_ACTIVITY_TABLE_SUMMARY,g),"' border\x3d'0' cellpadding\x3d'"+h+"' cellspacing\x3d'0' width\x3d'100%' class\x3d'"+d+"'\x3e");a.push("\x3cthead\x3e");a.push("\x3ctr\x3e");for(d=0;d<this._layout.length;d++)h=this._layout[d],this._rowSpan=this._rowSpan<h.fields.length?h.fields.length:this._rowSpan,g=this._getMetaByFieldId(h.fields[0]),a.push("\x3cth align\x3d'left' nowrap class\x3d'"+e+"' width\x3d'"+juic.escapeHTML(h.weight)+"%'\x3e"),g&&g.label?
a.push(Util.escapeHTML(g.label)):a.push(Util.escapeHTML(h.fields[0])),a.push("\x3c/th\x3e");if(this._isEditable&&0<this._permission.length||this.dataHasDeeplink)a.push("\x3cth align\x3d'left' class\x3d'"+e+"'\x3e"),this._printMode||a.push(MSGS.DEVELOPMENT_TRANSCRIPT_FILTER_ACTION),a.push("\x3c/th\x3e");a.push("\x3c/tr\x3e");a.push("\x3c/thead\x3e");a.push("\x3ctbody\x3e");a.push(c.join(""));a.push("\x3c/tbody\x3e");a.push("\x3c/table\x3e")}b||this._createAddButton(a)},_createAddButton:function(a){var b=
!1;this.isPlateauEnabled&&(b=!this.manualAddEnabled&&!this._hasLearningAccess);this._printMode||!this._isAllowCreate()||b||(a.push("\x3ctable border\x3d'0' cellpadding\x3d'1' cellspacing\x3d'1' width\x3d'100%'\x3e"),a.push("\x3ctr\x3e"),a.push("\x3ctd valign\x3d'middle' nowrap class\x3d'cdpItgAddLearningActivityButton'\x3e"),a.push("\x3cspan tabIndex\x3d'0' role\x3d'buttons' id\x3d'"+this.id+"_AddNew'"),a.push("onclick\x3d'"+this.fireCode("_addNewLA")+"' "),a.push("class\x3d'cdpItgCreateLA'\x3e"),
a.push(MSGS.DEVELOPMENT_TRANSCRIPT_ADD_ACTIVITY),a.push("\x26#160;\x26#160;\x26#160;\x26#160;"),a.push("\x3c/span\x3e"),a.push("\x3c/td\x3e\x3c/tr\x3e"),a.push("\x3c/table\x3e"),(this.manualAddEnabled||this.isPlateauEnabled)&&this._addContextMenu(this.id+"_AddNew"));a.push("\x3c/br\x3e")},_createAddButtonConsistency:function(a){var b=!1;this.isPlateauEnabled&&(b=!this.manualAddEnabled&&!this._hasLearningAccess);this._printMode||!this._isAllowCreate()||b||(a.push("\x3ctable border\x3d'0' cellpadding\x3d'1' cellspacing\x3d'1' width\x3d'100%' class\x3d'cdpItgCreateTableConsistency'\x3e"),
a.push("\x3ctr\x3e"),a.push("\x3ctd valign\x3d'middle' nowrap style\x3d'' class\x3d'cdpItgAddLearningActivityButton'\x3e"),this.manualAddEnabled||this.isPlateauEnabled?(this._addContextMenuDropDown(this.id+"_AddNew"),a.push(this._addNewContextMenu)):(a.push("\x3cspan tabIndex\x3d'0' role\x3d'buttons' id\x3d'"+this.id+"_AddNew' class\x3d'cdpItgCreateLAConsistency' "),a.push("onclick\x3d'"+this.fireCode("_onAddLearningActivityFindCatelog")+"' \x3e"),a.push("\x3cspan class\x3d'cdpItgCreateLAConsistencyAddIcon'\x3e\x26#xe058;\x3c/span\x3e"),
a.push("\x3ca\x3e"),a.push(MSGS.DEVELOPMENT_TRANSCRIPT_ADD_ACTIVITY),a.push("\x3c/a\x3e\x3c/span\x3e")),a.push("\x3c/td\x3e\x3c/tr\x3e"),a.push("\x3c/table\x3e"))},_showLoadingBox:function(a){this.loadingBox||(this.loadingBox=new SFLoading(""));this.loadingBox.setMsg(a);SFOverlayMgr.showOverlay(this.loadingBox,!0)},_hideLoadingBox:function(){this.loadingBox&&this.loadingBox.hide()},_getLabelByValue:function(a,b){for(var c=0;c<b.length;c++){var e=b[c];if(e.value==a)return e.style?'\x3cspan style\x3d"'+
e.style+'"\x3e'+Util.escapeHTML(e.label)+"\x3c/span\x3e":Util.escapeHTML(e.label)}return""},_addNewLA:function(){this._addNewContextMenu?(this._addNewContextMenu.hide(),this._addNewContextMenu.show()):this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,formSubjId:this._formSubjId})},_isAllowDelete:function(a){return this._isEditable?this.isPlateauEnabled?a.deletable:!0:!1},_isAllowCreate:function(){if(this._isEditable&&!this._goalCompleted)for(var a=0;a<this._permission.length;a++)if("create"==
this._permission[a])return!0;return!1},_addContextMenu:function(a){var b=[];(!this.isPlateauEnabled||this.isPlateauEnabled&&this._hasLearningAccess)&&b.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_FIND,value:"FindInCatalog",styleClass:""});this.isPlateauEnabled&&1==this._planType&&this._hasCompetencies&&this._hasLearningAccess&&b.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_SEARCH_BY_COMPETENCY,value:"SearchByCompetency",styleClass:""});this.manualAddEnabled&&b.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_CUSTOM,
value:"CustomLearningActivity",styleClass:""});this._addNewContextMenu=new sfPopMenu(a,b);this._addNewContextMenu.addEventListener("menuSelected",this)},_addContextMenuDropDown:function(a){a=[];(!this.isPlateauEnabled||this.isPlateauEnabled&&this._hasLearningAccess)&&a.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_FIND,disabled:!1,actionCommand:"FindInCatalog"});this.isPlateauEnabled&&1==this._planType&&this._hasCompetencies&&this._hasLearningAccess&&a.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_SEARCH_BY_COMPETENCY,
disabled:!1,actionCommand:"SearchByCompetency"});this.manualAddEnabled&&a.push({label:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_CUSTOM,disabled:!1,actionCommand:"CustomLearningActivity"});this._addNewContextMenu=new SFDropMenu(a,{content:'\x3cdiv\x3e\x3cspan class\x3d"tgm-objective-action-icon globalIconFont1Support uiConsistencyIcon" data-icon\x3d""\x3e\x26#xe058;\x3c/span\x3e\x26nbsp;\x26nbsp;'+MSGS.DEVELOPMENT_TRANSCRIPT_ADD_ACTIVITY+"\x3c/div\x3e",title:MSGS.DEVELOPMENT_TRANSCRIPT_ADD_ACTIVITY,css:"tgm-objective-actions",
activeCss:"tgm-objective-action-act",popupCss:"tgm-objective-actions-pop menuDefault"});this._addNewContextMenu.addEventListener("action",this,"_onAddLearningActivity")},_onAddLearningActivityFindCatelog:function(){this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,formSubjId:this._formSubjId})},_onAddLearningActivity:function(a){switch(a.actionCommand){case "CustomLearningActivity":this._invokeActivityDetailPage({isNew:!0,selectedUserId:this._selectedUserId,objId:this._objId});
break;case "FindInCatalog":this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,extURLType:this._getExtUrlTypeForFindInCatalog(),formSubjId:this._formSubjId});break;case "SearchByCompetency":this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,extURLType:this._getExtUrlTypeForSearchByCompetency(),formSubjId:this._formSubjId},!0)}},_getColSpan:function(a,b,c,e){for(var d=1;a<c&&!e[a].fields[b];a++)d++;return d},getValueByFieldId:function(a,b){if(this.rowData)for(var c=
0;c<this.rowData.length;c++){var e=this.rowData[c];if(e.id==a)return e}return null},_getMetaByFieldId:function(a){if(this._meta)for(var b=0;b<this._meta.length;b++){var c=this._meta[b];if(c.id==a)return c}return null},_invokeActivityDetailPage:function(a){if(this._dao&&a){this.controller&&this.controller.cleanup();var b=SFDom.getViewportHeight();this.controller=new EmbedController(this._dao,{width:900,height:450>b?b-150:450});"undefined"!=typeof MSGS&&"undefined"==typeof ISO8601Dateformatter&&(ISO8601Dateformatter=
new DateFormat(ComponentConsts.ISO8601DATEFORMAT),dateformatter=new DateFormat(MSGS.COMMON_DateFormat));this.controller.addEventListener("activitySaved",this);this.controller.addEventListener("activityLoaded",this);this.controller.addEventListener("activityEditorMessage",this);a.isNew&&void 0!=a.selectedUserId&&void 0!=a.objId?(this.controller.setUserId(a.selectedUserId),this.controller.setObjId(a.objId),this.controller.setFormSubjId(this._formSubjId),this._showLoadingBox(MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_LOAD),
this.controller.loadData()):a.isNew||void 0==a.selectedUserId||void 0==a.activityId?alert("Wrong paramaters."):(this.controller.setActivityId(a.activityId),this.controller.setUserId(a.selectedUserId),this.controller.setFormSubjId(this._formSubjId),this._showLoadingBox(MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_LOAD),this.controller.loadData())}},_getExtUrlTypeForFindInCatalog:function(){return 0==this._planType?EXT_URL_TYPE_TGM_CATALOG_SEARCH:4==this._planType?EXT_URL_TYPE_CDP_CWS_CATALOG_SEARCH:EXT_URL_TYPE_CDP_FIND_IN_CATALOG},
_getExtUrlTypeForSearchByCompetency:function(){return 4==this._planType?EXT_URL_TYPE_CDP_CWS_SEARCH_BY_COMPETENCY:EXT_URL_TYPE_CDP_SEARCH_BY_COMPETENCY},_showIframeDialog:function(a,b,c,e){if(!window.LEARNING_IFRAME_DIALOG){var d=getFitDialogSize(970,500);window.LEARNING_IFRAME_DIALOG=new LMSIframeDialog({width:d.width,height:d.height,buttons:c,title:a});window.LEARNING_IFRAME_DIALOG.addEventListener("action",this)}window.LEARNING_IFRAME_DIALOG.setButtons(c);window.LEARNING_IFRAME_DIALOG.show();e?
window.LEARNING_IFRAME_DIALOG.postData(b,e):window.LEARNING_IFRAME_DIALOG.loadURL(b)},findInCatalog:function(a,b){this._proxyUserFullName&&""!=this._proxyUserFullName&&!confirm(sfMessageFormat.format(MSGS.DEVELOPMENT_LMS_HOME_PROXY_CONFIRM,[this._proxyUserFullName]))||this.model.findInCatalog(a,b)},_deeplinkClick:function(a,b){this.model.getDeepLink({id:a,planType:b})},_getMoreDetails:function(a){this.model.getMoreDetails({id:a.id,selectedUserId:a.selectedUserId,planType:a.planType})},_deleteClick:function(a,
b,c){confirm(MSGS.DEVELOPMENT_TRANSCRIPT_DELETE_CONFIRM)&&(a={id:a,objId:this._objId},c&&""!=c&&(a.formSubjId=c),this.model.deleteTranscriptFromObj(a))},_editActivity:function(a){this._invokeActivityDetailPage({isNew:!1,activityId:a,selectedUserId:this._selectedUserId})},_getMoreDetailsAction:function(a,b){this._getMoreDetails({id:a,selectedUserId:b,planType:this._planType})},handleEvent:function(a){switch(a.type){case "activityLoaded":this._hideLoadingBox();break;case "activitySaved":0<document.forms.length&&
document.forms[0].submit();break;case "activityEditorMessage":this._hideLoadingBox();this.dialog||(this.dialog=new CDPErrorDialog);a.errorMap=[{value:""}];this.dialog.showDialog(a);break;case "action":a.param&&"editActivity"==a.param.actionCommand&&this._invokeActivityDetailPage({isNew:!1,activityId:a.param.activityId,selectedUserId:this._selectedUserId});a.param&&"getMoreDetails"==a.param.actionCommand&&this._getMoreDetails({id:a.param.id,selectedUserId:a.param.selectedUserId,planType:this._planType});
a.actionCommand&&"refresh"==a.actionCommand&&(this.notificationDialog&&this.notificationDialog.close(),0<document.forms.length&&document.forms[0].submit());if(a&&a.menuItem&&"delete"==a.actionCommand){var b=a.menuItem.dataid;this._deleteClick(b,a.menuItem.isFromCatalog)}a&&a.menuItem&&"deeplink"==a.actionCommand&&(b=a.menuItem.dataid,this._deeplinkClick(b,a.menuItem.planType));break;case "menuSelected":switch(a.value){case "CustomLearningActivity":this._invokeActivityDetailPage({isNew:!0,selectedUserId:this._selectedUserId,
objId:this._objId});break;case "FindInCatalog":this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,extURLType:this._getExtUrlTypeForFindInCatalog(),formSubjId:this._formSubjId});break;case "SearchByCompetency":this.findInCatalog({selectedUserId:this._selectedUserId,objId:this._objId,extURLType:this._getExtUrlTypeForSearchByCompetency(),formSubjId:this._formSubjId},!0)}break;case EVT_LMS_FIND_IN_CATALOG_FINISHED:this.isPlateauEnabled?this._showIframeDialog(MSGS.DEVELOPMENT_TRANSCRIPT_FIND_DLG_TITLE,
a.lms_server_url,[{label:MSGS.COMMON_Done,eventName:"refresh",active:!0}],a.data):(openStandardWindow(a.lms_server_url),this.notificationDialog||(this.notificationBody=new CDPHtmlSection(MSGS.DEVELOPMENT_TRANSCRIPT_FIND_DLG_BODY),this.notificationDialog=new SFDialog(MSGS.DEVELOPMENT_TRANSCRIPT_FIND_DLG_TITLE,this.notificationBody,[{label:MSGS.COMMON_Ok,eventName:"refresh",active:!0}],500,180),this.notificationDialog.addEventListener("action",this)),SFOverlayMgr.showOverlay(this.notificationDialog,
!0));break;case EVT_GET_DEEP_LINK_DONE:this.isPlateauEnabled?window.location="/xi/ui/learning/pages/learning.xhtml?destUrl\x3d"+encodeURIComponent(a.deepLink):openStandardWindow(a.deepLink);break;case EVT_GET_MORE_DETAIL_DONE:this._showIframeDialog(MSGS.DEVELOPMENT_MORE_DETAILS_LABEL,a.detailLink,[{label:MSGS.COMMON_Done,eventName:"hide",active:!0}]);break;case EVT_DELETE_LA_FROM_OBJ_DONE:0<document.forms.length&&document.forms[0].submit();break;case EVT_LMS_AJAX_START:this._showLoadingBox(a.msg?
a.msg:MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_LOAD);break;case EVT_LMS_AJAX_END:this._hideLoadingBox();break;case EVT_LMS_ERROR_MESSAGE:alert(a.msg);break;default:assert(!0,"not handler for event:"+a.type)}}})}();
function ActivityIntegrationSFLMS(a,b){this.register();this.model=new ActivityIntegrationModel(a);this.model.addEventListener(EVT_LMS_FIND_IN_CATALOG_FINISHED,this);this.model.addEventListener(EVT_LMS_AJAX_START,this);this.model.addEventListener(EVT_LMS_AJAX_END,this);this.model.addEventListener(EVT_LMS_ERROR_MESSAGE,this);this.model.addEventListener("action",this);this._proxyUserFullName=b}
ActivityIntegrationSFLMS.prototype=function(){return set(new Component,{findInCatalog:function(a,b){this._proxyUserFullName&&""!=this._proxyUserFullName&&!confirm(sfMessageFormat.format(MSGS.DEVELOPMENT_LMS_HOME_PROXY_CONFIRM,[this._proxyUserFullName]))||this.model.findInCatalog(a,b)},handleEvent:function(a){switch(a.type){case EVT_LMS_FIND_IN_CATALOG_FINISHED:this._showIframeDialog(MSGS.DEVELOPMENT_TRANSCRIPT_FIND_DLG_TITLE,a.lms_server_url,[{label:MSGS.COMMON_Done,eventName:"Done",active:!0}],a.data);
break;case EVT_LMS_AJAX_START:this._showLoadingBox(a.msg?a.msg:MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_LOAD);break;case EVT_LMS_AJAX_END:this._hideLoadingBox();break;case EVT_LMS_ERROR_MESSAGE:alert(a.msg);break;case "action":a.actionCommand&&"Done"==a.actionCommand&&this._hideIframeDialog(),this.dispatchEvent(a)}},_showLoadingBox:function(a){this.loadingBox||(this.loadingBox=new SFLoading(""));this.loadingBox.setMsg(a);SFOverlayMgr.showOverlay(this.loadingBox,!0)},_hideLoadingBox:function(){this.loadingBox&&
this.loadingBox.hide()},_showIframeDialog:function(a,b,c,e){window.LEARNING_IFRAME_DIALOG||(window.LEARNING_IFRAME_DIALOG=new LMSIframeDialog({width:970,height:500,buttons:c,title:a}),window.LEARNING_IFRAME_DIALOG.addEventListener("action",this));window.LEARNING_IFRAME_DIALOG.setButtons(c);window.LEARNING_IFRAME_DIALOG.show();e?window.LEARNING_IFRAME_DIALOG.postData(b,e):window.LEARNING_IFRAME_DIALOG.loadURL(b)},_hideIframeDialog:function(){window.LEARNING_IFRAME_DIALOG&&window.LEARNING_IFRAME_DIALOG.closeDialog()}})}();
function ActivityIntegrationModel(a){this._dao=a}
ActivityIntegrationModel.prototype=function(){return set(new EventTarget,{findInCatalog:function(a,b){var c=JSON.stringify(a),e=this._getCommonCallbackObj();e.callback=function(a){e.model.dispatch(EVT_LMS_AJAX_END);a=eval("("+a+")");if(a.success)e.model.dispatch(EVT_LMS_FIND_IN_CATALOG_FINISHED,{lms_server_url:a.lms_server_url,data:a.params});else{var c=b?MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_SEARCH_BY_COMPETENCY_FAIL:MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_FIND_FAIL;a.message&&(c+="\n"+a.message);e.model.dispatch(EVT_LMS_ERROR_MESSAGE,
{msg:c})}};this.dispatch(EVT_LMS_AJAX_START);this._dao.findInCatalog(c,e)},getDeepLink:function(a){a=JSON.stringify(a);var b=this._getCommonCallbackObj();b.callback=function(a){b.model.dispatch(EVT_LMS_AJAX_END);a=eval("("+a+")");a.success?b.model.dispatch(EVT_GET_DEEP_LINK_DONE,{deepLink:a.deepLink}):b.model.dispatch(EVT_LMS_ERROR_MESSAGE,{msg:a.message})};this.dispatch(EVT_LMS_AJAX_START);this._dao.getDeepLink(a,b)},getMoreDetails:function(a){a=JSON.stringify(a);var b=this._getCommonCallbackObj();
b.callback=function(a){b.model.dispatch(EVT_LMS_AJAX_END);a=eval("("+a+")");a.success?b.model.dispatch(EVT_GET_MORE_DETAIL_DONE,{detailLink:a.detailLink}):b.model.dispatch(EVT_LMS_ERROR_MESSAGE,{msg:a.message})};this.dispatch(EVT_LMS_AJAX_START,MSGS.DEVELOPMENT_TRANSCRIPT_EVENT_MOREDETAILS);this._dao.getMoreDetails(a,b)},deleteTranscriptFromObj:function(a){a=JSON.stringify(a);var b=this._getCommonCallbackObj();b.callback=function(a){b.model.dispatch(EVT_LMS_AJAX_END);a=eval("("+a+")");a.success?b.model.dispatch(EVT_DELETE_LA_FROM_OBJ_DONE):
b.model.dispatch(EVT_LMS_ERROR_MESSAGE,{msg:a.message})};this.dispatch(EVT_LMS_AJAX_START);this._dao.deleteTranscriptFromObj(a,b)},_getCommonCallbackObj:function(){var a={model:this,exceptionHandler:function(b,c){a.model.dispatch(EVT_LMS_AJAX_END);a.model.dispatch(EVT_LMS_ERROR_MESSAGE,{msg:b})},errorHandler:function(b,c){a.model.dispatch(EVT_LMS_AJAX_END);a.model.dispatch(EVT_LMS_ERROR_MESSAGE,{msg:b})},timeout:12E4};return a}})}();