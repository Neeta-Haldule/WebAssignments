function PMRating(a,b,c,d){this.index=a;this.value=b;this.label=juic.escapeHTML(c);this.showValue=d}(function(){extend(PMRating,Object,{setShowValue:function(){}})})();PMRating.prototype.toString=function(){return this.showValue?"-1972.0"==this.value||"-1972"==this.value?this.label:"-9999.0"==this.value||"-9999"==this.value?"--":"-1971.0"==this.value||"-1971"==this.value?this.label:this.value==this.label?this.value:this.value+" - "+this.label:this.label};
function PMReviewRatingModel(a,b,c,d,e,f,g,h){this.init(a,b,c,d,e,f,g,h)}
(function(){extend(PMReviewRatingModel,EventTarget,{init:function(a,b,c,d,e,f,g,h){this.beforSignature=a.isbeforSign();this.subject=c;this.currentUser=d;this.calculatedPermitted=f;this.officialRatingLabel=g;this.overallRatingLabel=h;e&&(this.selfReview=!0);this.summaryVO=b;this.setConfiguration();this.initRatingDesc()},initRatingDesc:function(){var a,b,c;if(!this.invalidRating)if(this.manualRating)if(this.beforSignature){a=this.overallRatingLabel?this.overallRatingLabel:MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE;
var d=this.getCalculatedRating();this.adjustRatingEnabled&&!this.displayCalculatedRating()&&(d=this.getAdjustRating());c=[];this.calculatedPermitted&&(c=[{label:MSGS.PERFORMANCE_UNADJUSTED_CALCULATED_RATING_LABEL,value:d.toString()}]);this.selfReview?b=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE_IS_CALCULATED,this.subject.firstName):(b=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE_IS_THE_MANUAL_RATING_OF,this.getRating().toString())+" ",this.calculatedPermitted&&(b+=
sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_CALCULATED_SCORE_IS,d.toString())))}else a=this.officialRatingLabel?this.officialRatingLabel:MSGS.PERFORMANCE_REVIEW_FINAL_SCORE,this.selfReview?b=void 0:(d=this.getCalculatedRating(),this.adjustRatingEnabled&&!this.displayCalculatedRating()&&(d=this.getAdjustRating()),b=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_FINAL_SCORE_IS_THE_MANUAL_RATING_OF,this.getRating().toString())+" ",this.calculatedPermitted&&(b+=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_CALCULATED_SCORE_IS,
d.toString()))),c=void 0;else this.beforSignature?(a=this.overallRatingLabel?this.overallRatingLabel:MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE,d=this.getCalculatedRating(),this.adjustRatingEnabled&&!this.displayCalculatedRating()&&(d=this.getAdjustRating()),c=[{label:MSGS.PERFORMANCE_ADJUSTED_CALCULATED_RATING_LABEL,value:d.toString()}],b=this.selfReview?sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE_IS_CALCULATED,this.subject.firstName):sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE_IS_THE_CALCULATED_SCORE_OF,
this.getRating().toString())):(a=this.officialRatingLabel?this.officialRatingLabel:MSGS.PERFORMANCE_REVIEW_FINAL_SCORE,this.selfReview?(b=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_OVERALL_SCORE_OF_FINAL_SCORE,this.getRating().toString())+"\x3cbr/\x3e"+sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_FINAL_SCORE_IS_CALCULATED,this.subject.firstName),c=this.getEsRating(),d=MSGS.PERFORMANCE_ADJUSTED_CALCULATED_RATING_LABEL_AT_SIGNATURE_STAGE,this.officialRatingLabel&&(d=this.officialRatingLabel),
c=[{label:d,value:this.getRating().toString()},{label:sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_SELF_RATING_LABEL,this.subject.firstName),value:c.toString()}]):(b=sfMessageFormat.format(MSGS.PERFORMANCE_REVIEW_FINAL_SCORE_IS_THE_CALCULATED_SCORE_OF,this.getRating().toString()),c=[]));this.ratingDesc={title:a,caption:b,footer:c}},setConfiguration:function(){var a=this.summaryVO;this.adjustRatingEnabled=null==this.summaryVO.adjustedRating?!1:!0;a.overallRating.ratingScale?(this.manualRating=a.summaryManualRating?
a.summaryManualRating:!1,this.showValue=a&&a.overallRating&&a.overallRating.ratingScale&&a.overallRating.ratingScale.showValue?a.overallRating.ratingScale.showValue:!1):this.invalidRating=!0},refresh:function(a){this.summaryVO=a;this.initRatingDesc()},getManualRating:function(){var a=this.summaryVO?this.summaryVO.overallRating.rating:void 0,b=this.summaryVO?this.summaryVO.overallRating.textRating:"undefine label",c=this.getRatingIndex(this.summaryVO?this.summaryVO.overallRating.formattedRating:void 0);
return new PMRating(c,a,b,this.showValue)},getAdjustRating:function(){var a=this.summaryVO?this.summaryVO.adjustedRating.rating:void 0,b=this.summaryVO?this.summaryVO.adjustedRating.textRating:"undefine label",c=this.getRatingIndex(this.summaryVO?this.summaryVO.adjustedRating.formattedRating:void 0);return new PMRating(c,a,b,this.showValue)},displayCalculatedRating:function(){return this.summaryVO.displayCalculatedRating},getCalculatedRating:function(){var a=this.summaryVO?this.summaryVO.calculatedRating:
void 0,b=this.summaryVO?this.summaryVO.calculatedRatingLabel:"undefine label",c=this.getRatingIndex(this.summaryVO?this.summaryVO.calculatedRating:void 0);return new PMRating(c,a,b,this.showValue)},mappingRating:function(a,b){for(var c=0;c<b.length&&(scaleItem=b[c],a!=scaleItem.value);c++);return{index:c,scale:b[c]}},getRatingIndex:function(a){var b=void 0;this.summaryVO.overallRating.ratingScale&&(b=this.mappingRating(a,this.summaryVO.overallRating.ratingScale.scaleValues).index);return b},getRating:function(){var a,
b;this.beforSignature?(a=this.summaryVO?this.summaryVO.overallRating.rating:void 0,b=this.summaryVO?this.summaryVO.overallRating.textRating:"undefine label"):(a=this.summaryVO?this.summaryVO.officialOverallRating.rating:void 0,b=this.summaryVO?this.summaryVO.officialOverallRating.textRating:"undefine label");return new PMRating(void 0,a,b,this.showValue)},getSummaryRating:function(){return this.manualRating?this.beforSignature?this._m.reviewRatingModel.getManualRating():this._m.reviewRatingModel.getRating():
this._m.reviewRatingModel.getRating()},getEsRating:function(){var a,b;this.beforSignature||(a=this.summaryVO?this.summaryVO.overallRating.rating:void 0,b=this.summaryVO?this.summaryVO.overallRating.textRating:"undefine label");return new PMRating(void 0,a,b,this.showValue)},getRatingDesc:function(){return this.ratingDesc}})})();