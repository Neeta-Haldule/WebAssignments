function FormFactory(a,b,c){this.init(a,b,c)}
extend(FormFactory,EventTarget,{init:function(a,b,c){this.m=a;this.rPath=b;this.formConf=c;this.COMMENT_MAX_COUNT=4E3;this.UNDEFINED_VALUE=-1;this.item=this.m.getData(this.rPath)},generateFormMeta:function(){var a=[],b=this.formConf.ratingOption,c=this.formConf.hasItemComment;if(this.formConf.rateByBehavior)c&&(1!=b&&2!=b||this._generateCurrentUserRating(a),a.push(this.getCommentMeta()));else switch(b){case 0:this._generateOfficialRating(a);c&&a.push(this.getCommentMeta());break;case 1:this._generateOfficialRating(a);
c&&(this._generateCurrentUserRating(a),a.push(this.getCommentMeta()));break;case 2:this._generateOfficialRating(a);c&&(this._generateCurrentUserRating(a),a.push(this.getCommentMeta()));break;case 3:this.formConf.ezRaterEnabled||this._generateCurrentUserRating(a),c&&a.push(this.getCommentMeta())}return a},_generateOfficialRating:function(a){this.formConf.ezRaterEnabled||a.push(this.getRatingMeta("ratingOfRecord"))},_generateCurrentUserRating:function(a){a.push(this.getRatingMeta("itemRatingComment"))},
getRatingMeta:function(a){return{type:"rating",dataPath:this.rPath+"/"+a}},getRatingMetaByDataPath:function(a,b){return{type:"rating",dataPath:a,isBehaviorRating:b}},getCommentMeta:function(){return{type:"cmt",dataPath:this.rPath+"/itemRatingComment",spellCheck:this.formConf.spellCheck,legalScan:this.formConf.legalScan,waca:this.formConf.waca}},getCommentMetaByDataPath:function(a){return{type:"cmt",dataPath:a,spellCheck:this.formConf.spellCheck,legalScan:this.formConf.legalScan,waca:this.formConf.waca}},
generateForm:function(a){for(var b=[],c=0;c<a.length;c++){var e=this.generateComp(a[c]);e&&b.push(e)}return b},generateSectionPath:function(a){a=a.dataPath.substring(0,a.dataPath.lastIndexOf("/"));a=a.substring(0,a.lastIndexOf("/"));return a.substring(0,a.lastIndexOf("/"))},generateComp:function(a){var b={};b.type=a.type;switch(a.type){case "rating":var c=this.m.getData(a.dataPath+"/ratingPerm");if(c&&"none"!=c.name){var e=this.m.getData(a.dataPath+"/ratingKey"),g=this.m.getData(a.dataPath+"/rating"),
d=this.m.getData(a.dataPath+"/textRating"),f=this.m.getData(a.dataPath+"/sourceRating"),l=this.m.getData(a.dataPath+"/expectedRating"),p=!0;"write"!=c.name||this.formConf.isMLT||(p=!1);var m,n,c=[];m=!1;n="STAR";var h;if(h=a.isBehaviorRating?this.formConf.behaviorRatingScale?this.formConf.behaviorRatingScale:this.formConf.ratingScale:this.formConf.ratingScale)c=h.scaleValues,m=h.showValue,n=h.scaleType;h=[];for(var q=[],k=0;k<c.length;k++)h[k]=c[k].value,q[k]=c[k].desc;b.instance=new PM2Rating(e,
g,d,{readOnly:p,ratingValues:h,ratingDesc:q,isMLT:this.formConf.isMLT},n,m,l,f);g=this.m.getData(a.dataPath+"/ratingRequired");e=this.m.getData(a.dataPath+"/ratingLabel");f=b.instance.id;d=this.generateSectionPath(a);l=d+"/ratingScale";a.isBehaviorRating&&this.formConf.behaviorRatingScale&&(l=d+"/behaviorRatingScale");b.label=new PMRatingLabel(e,f,{required:g,isShowRatingHelpIcon:this.formConf.isShowRatingHelpIcon,ratingScale:{m:this.m,path:l}});b.required&&(PMValidationUtil.bindRequiredValidator(b.instance),
b.registerEvents=["rateSelected"])}break;case "cmt":if((c=this.m.getData(a.dataPath+"/commentsPerm"))&&"none"!=c.name){e=this.m.getData(a.dataPath+"/commentKey");f=this.m.getData(a.dataPath+"/comment");if(this.m.getData(this.rPath+"/suppressItemComments"))b.instance=new SFSpan("");else if("write"==c.name){g=this.m.getData(a.dataPath+"/commentRequired");d=this.generateSectionPath(a);d=this.m.getData(d+"/sectionCommentsMaxLimit");g&&(d=this.m.getData(a.dataPath+"/commentRequiredMaxValue"));if(this.formConf.rte){if(0<
d&&100>d)d=100;else if(4E3<d||0>d)d=4E3;d={hideWaca:!0,hideSpellCheck:a.spellCheck?!1:!0,hideLegalScan:a.legalScan?!1:!0,wacaEnabled:a.waca,maxChars:d,eleId:e,label:this.m.getData(a.dataPath+"/commentLabel")};b.instance=new PM2RteWrap(f,d);b.registerEvents=["openWritingAssistant"]}else 0>d&&(d=4E3),b.instance=new PM2PlainTextWrap(f,{eleId:e,maxLength:d,rows:3,width:"100%;"}),b.registerEvents=[];window[e]=b.instance;b.instance.bindProperty(this.m,a.dataPath+"/comment");e=this.COMMENT_MAX_COUNT;d=this.UNDEFINED_VALUE;
g&&(e=this.m.getData(a.dataPath+"/commentRequiredMaxValue"),d=this.m.getData(a.dataPath+"/commentRequiredMinValue"));"COMPETENCY"!==this.item.itemType&&"SUMMARY"!==this.item.itemType||!this.formConf.teamRaterEnabled?g&&(PMValidationUtil.bindRequiredValidator(b.instance),PMValidationUtil.bindLengthValidator(b.instance,d,e),b.registerEvents.push("change")):(g&&(PMValidationUtil.bindRequiredValidator(b.instance),0>e||e>this.COMMENT_MAX_COUNT)&&(e=this.COMMENT_MAX_COUNT),PMValidationUtil.bindLengthValidator(b.instance,
d,e),b.registerEvents.push("change"))}else"read"==c.name&&(b.instance=this.formConf.rte?new PMUTextTruncate(f,{displayChars:300,defaultStr:MSGS.PERFORMANCE_REVIEW_HAS_NOT_COMMENTED_YET}):formConfig.unEscapePlainText?new PMUTextTruncate(f,{displayChars:300,defaultStr:MSGS.PERFORMANCE_REVIEW_HAS_NOT_COMMENTED_YET}):new PMUTextTruncate(juic.escapeHTML(f,"\x3cbr/\x3e"),{displayChars:300,defaultStr:MSGS.PERFORMANCE_REVIEW_HAS_NOT_COMMENTED_YET}));b.instance&&(g=this.m.getData(a.dataPath+"/commentRequired"),
e=this.m.getData(a.dataPath+"/commentLabel"),f=b.instance instanceof PM2RteWrap||b.instance instanceof PM2PlainTextWrap?b.instance.getContentId():b.instance.id,this.m.getData(this.rPath+"/suppressItemCommentsLabel")&&(e=""),b.label=new PM2Label(e,f,{required:g}))}break;default:alert("Need UI support for this type::"+a.type)}return b.instance?b:null}});function RowLayout(){this.register();this.rows=[]}
extend(RowLayout,Component,{creatRow:function(a,b){this.rows.push({label:a,field:b})},renderHtml:function(a){a=0;for(var b=this.rows.length;a<b;a++);}});