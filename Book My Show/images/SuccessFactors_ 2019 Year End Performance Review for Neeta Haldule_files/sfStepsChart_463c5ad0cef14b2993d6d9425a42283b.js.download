SFStepsChart.GLOBAL_PRIMARY_BUTTON="globalPrimaryElement";function SFStepsChart(a){this.register();this._init(a)}
(function(){juic.extend(SFStepsChart,juic.Component,{_init:function(a){this._data=a;this._stages=this._data.stepsChartStageList;this._stagesComponents=[];this._stagesConnectors=[];this._isShow=!0;this._currentStep=null;var b=this._data.enableStepActions;if(this._stages)for(var c=0,d=this._stages.length;c<d;c++){var e=this._stages[c];a=!1;var f=e.stepsChartStepVOList;this._stepCount=f?f.length:0;e.enableStepActions=b;e=new SFStepsChartStage(e,this._data.currentStepActionList);this._stagesComponents.push(e);
e.addEventListener("stepClick",this);e.addEventListener("stepInfoClick",this);e.addEventListener("menuItemClicked",this);c!=d-1&&(f&&f[this._stepCount-1]&&f[this._stepCount-1].completed&&(a=!0),this._stagesConnectors.push(new SFStepsChartSeparator(!1,a)));this._initCurrentStep(this._stagesComponents[c])}SFBodyEventDispatcher.addResizeListener(this,"handleStepsChartResize");this._timeoutHandle},renderHtml:function(a){a.addAfterRenderListener(this,"postRender");a.push('\x3cdiv id\x3d"',this.id,'_topLevelContainer" class\x3d"sfStepsChartTopLevelContainer" style\x3d"width:0px;"\x3e');
a.push('\x3cdiv id\x3d"',this.id,'"\x3e');a.push('\x3cdiv id\x3d"',this.id,'_stepsChartContainer" class\x3d"globalPortletBodyBackground sfStepsChartContainer"\x3e');this.renderStages(a);a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");a.push('\x3cdiv id\x3d"',this.id,'_hiddenMessage" style\x3d"display: none; padding: 20px;"\x3e');a.push(juic.escapeHTML(this._data.collapsableString)||"");a.push("\x3c/div\x3e");a.addAfterRenderListener(this,"_afterRender")},handleEvent:function(a){switch(a.type){case "stepClick":this.dispatch(a.type,
{stage:a.stage,step:a.step});break;case "stepInfoClick":this.dispatch(a.type,{step:a.step,infoId:a.infoId});break;default:this.dispatchEvent(a)}},getTopLevelContainer:function(){return juic.$(that.id+"_topLevelContainer")},_afterRender:function(a){},renderStages:function(a){for(var b=0,c=this._stagesComponents.length;b<c;b++)this._stagesComponents[b].renderHtml(a),"undefined"!=typeof this._stagesConnectors[b]&&this._stagesConnectors[b].renderHtml(a)},postRender:function(){this.adjustDOM()},handleStepsChartResize:function(){var a=
this;clearTimeout(this._timeoutHandle);this._timeoutHandle=setTimeout(function(){a.adjustDOM()},500)},adjustDOM:function(){if(this._isShow){var a=SFDom.getParent(juic.$(this.id+"_topLevelContainer"));SFDom.getRegion(a);for(var b=a=0,c=this._stagesComponents.length;b<c;b++)a+=this._stagesComponents[b].getWidth(),a=b!=c-1?a+50:a+32;juic.$(this.id+"_stepsChartContainer").style.width=a+"px";this.dispatch("adjustDOMComplete",{})}},getCurrentStepDomId:function(){for(var a=0;a<this._stagesComponents.length;a++){var b=
this._stagesComponents[a].getCurrentStepDomId();if(null!=b)return b}return null},_initCurrentStep:function(a){for(var b=0;b<a._stepsComponents.length;b++){var c=a._stepsComponents[b];if(c._currentStep){this._currentStep=c;break}}},_setAsNotCurrent:function(a){a&&(Util.removeClass(a,"sfCurrentStep"),Util.removeClass(a.parentNode,"sfCurrentStepContainer"),Util.removeClass(a,SFStepsChart.GLOBAL_PRIMARY_BUTTON))},_setAsCurrent:function(a){a&&(Util.removeClass(a,"globalSecondaryElement"),Util.addClass(a,
"sfCurrentStep"),Util.addClass(a.parentNode,"sfCurrentStepContainer"),Util.addClass(a,SFStepsChart.GLOBAL_PRIMARY_BUTTON))},setCurrentStep:function(a){a=a||this.getFirstStepDomId();var b=this.getCurrentStepDomId()||a,c=!1,d=!1;if(juic.$(b))for(b=0;b<this._stagesComponents.length;b++)for(var e=this._stagesComponents[b],f=0;f<e._stepsComponents.length;f++){var g=e._stepsComponents[f];g._currentStep?d=!0:g.getDomId()===a&&(g._currentStep=!0,this._currentStep=g,Util.removeClass(juic.$(a),"globalSecondaryElement"),
Util.addClass(juic.$(a),"sfCurrentStep"),Util.addClass(juic.$(a),SFStepsChart.GLOBAL_PRIMARY_BUTTON),c=!0);if(c&&d)break}},getCurrentStep:function(){return this._currentStep},setCurrentStepByStepOrder:function(a){var b=this.getCurrentStepDomId()||this.getFirstStepDomId(),c=!1,d=!1;if(juic.$(b))for(b=0;b<this._stagesComponents.length;b++)for(var e=this._stagesComponents[b],f=0;f<e._stepsComponents.length;f++){var g=e._stepsComponents[f],h=this.getStepDomId(g),h=juic.$(h);g._currentStep?(g._currentStep=
!1,d=!0,this._setAsNotCurrent(h)):g._data.stepOrder===a&&(g._currentStep=!0,this._currentStep=g,this._setAsCurrent(h),c=!0);if(c&&d)break}},getStepDomId:function(a){return a?a.id+"_step":null},getFirstStepDomId:function(){return this._stagesComponents[0]._stepsComponents[0].getDomId()},getSectionId:function(){return null},getItemId:function(){return null},getStepCount:function(){return this._stepCount},getWidth:function(){return juic.$(this.id+"_stepsChartContainer").style.width},showStepsChart:function(a){(this._isShow=
a)?(juic.$(this.id).style.display="",juic.$(this.id+"_hiddenMessage").style.display="none"):(juic.$(this.id).style.display="none",juic.$(this.id+"_hiddenMessage").style.display="");this.adjustDOM()}})})();function SFStepsChartStage(a,b){this.register();this._init(a,b)}
(function(){juic.extend(SFStepsChartStage,juic.Component,{_init:function(a,b){var c;this._data=a;this._currentStepActionList=b;this._stageName=this._data.stageName;this._steps=this._data.stepsChartStepVOList;this._stepsComponents=[];this._stepsConnectors=[];for(var d=0;d<this._steps.length;d++){c=!1;this._steps[d].stageName=this._stageName;this._steps[d].enableStepActions=this._data.enableStepActions;var e=new SFStep(this._steps[d],this._currentStepActionList);e.addEventListener("stepClick",this);
e.addEventListener("stepInfoClick",this);e.addEventListener("menuItemClicked",this);this._stepsComponents.push(e);d!=this._steps.length-1&&(this._steps[d].completed&&(c=!0),this._stepsConnectors.push(new SFStepsChartSeparator(!0,c,this._steps[d].stepName)))}},handleEvent:function(a){switch(a.type){case "stepClick":this.dispatch(a.type,{stage:this,step:a.step});break;case "stepInfoClick":this.dispatch(a.type,{step:a.step,infoId:a.infoId});break;default:this.dispatchEvent(a)}},renderHtml:function(a){a.push('\x3cdiv id\x3d"',
this.id,'" class\x3d"sfStepsChartDisplayInlineBlock globalPortletBody"\x3e');a.push('\x3cdiv class\x3d"sfStepsChartStageContainer globalPortletDimmedTextColor"\x3e');this.renderHeader(a);a.push("\x3c/div\x3e");a.push('\x3cul class\x3d"sfStepsChartStepsContainer"\x3e');this.renderSteps(a);a.push("\x3c/ul\x3e");a.push("\x3c/div\x3e")},renderHeader:function(a){this._stageName&&(a.push('\x3cdiv id\x3d"',this.id,'_stageNameLeft" class\x3d"sfStepsChartDisplayInlineBlock sfStepsChartOffsetMarker leftOffset"\x3e\x3c/div\x3e'),
a.push('\x3cdiv id\x3d"',this.id,'_stageName" class\x3d"sfStepsChartDisplayInlineBlock sfStepsChartStageName" aria-hidden\x3d"true"\x3e',this._stageName,"\x3c/div\x3e"),a.push('\x3cdiv id\x3d"',this.id,'_stageNameRight" class\x3d"sfStepsChartDisplayInlineBlock sfStepsChartOffsetMarker rightOffset"\x3e\x3c/div\x3e'),a.addAfterRenderListener(this,"postRender"))},renderSteps:function(a){for(var b=0,c=this._stepsComponents.length;b<c;b++)this._stepsComponents[b].renderHtml(a),"undefined"!=typeof this._stepsConnectors[b]&&
this._stepsConnectors[b].renderHtml(a)},postRender:function(){var a=SFDom.getRegion(this.id),b=SFDom.getRegion(this.id+"_stageName"),a=(a.width-b.width)/2-10;0<=a&&(juic.$(this.id+"_stageNameLeft").style.width=a+"px",juic.$(this.id+"_stageNameRight").style.width=a+"px")},getWidth:function(){if(juic.$(this.id))return juic.$(this.id).scrollWidth},getCurrentStepDomId:function(){for(var a=0,b=this._stepsComponents.length;a<b;a++)if(this._stepsComponents[a].isCurrentStep())return this._stepsComponents[a].getDomId();
return null},getFirstStepDomId:function(){return this._stepsComponents[0].getDomId()}})})();function SFStep(a,b){this.register();this._init(a,b)}
(function(){juic.extend(SFStep,juic.Component,{_init:function(a,b){this._data=a;this._currentStepActionList=b;this._stageName=this._data.stageName;this._stepName=this._data.stepName;this._selectedStepDescription=this._data.selectedStepDescription;var c=this._data.enableStepActions;this._enableStepActions="undefined"==typeof c||!!c;this._stepIcon=this._data.stepIcon;this._hideStepName=this._data.hideStepName||!1;this._noLabelClass=this._stepName?"":"sfStepsChartNoLabel";this._desc=this._data.description;
this._roleName=this._data.userRole||"";this._dueDate=this._data.dueDate;this._employeeName=this._data.userFullName;this._completed=this._data.completed||!1;this._currentStep=this._data.currentStep||!1;this._stepId=this._data.stepId||"";this._overDue=this._data.overDue;this._isIC="undefined"!=typeof this._data.icSubStepVOList;this._showInfoIcon=this._data.showInfoIcon;new SFContainer;if(this._currentStep&&null!=this._currentStepActionList&&0!=this._currentStepActionList.length){for(var c=[],d=0;d<
this._currentStepActionList.length;d++)this._currentStepActionList[d].enabled&&c.push({label:this._currentStepActionList[d].displayName,css:"sfStepsChartButtonItem",actionCommand:"menuItemClicked",workFlowButtonVO:this._currentStepActionList[d]});this._actionList=c}},_renderStepCircle:function(a,b){var c=b,d,e,f="";this._currentStep?(c+=" sfCurrentStep",d="sfStepsChartCurrent globalPrimaryButtonInverse"):this._completed?(c+=" sfCompletedStep",d="globalPositiveThresholdColor sfStepsChartCompleted"):
d="sfStepsChartGroupInactive";this._isIC&&!this._completed&&(d+=" sfStepsChartGroup");e=juic.escapeHTML(this._selectedStepDescription||this._stepName);a.push("\x3cdiv ");this._enableStepActions&&(a.push('tabindex\x3d"0" '),f=" sfStepsChartStepActive");a.push('aria-label\x3d"',e,'" ');a.push('title\x3d"',e,'" ');a.push('id\x3d"',this.id,'_step"');a.push('onclick\x3d"',this.fireCode("_handleStepEvent","stepClick"),'" ');a.push('onmouseover\x3d"',this.fireCode("_handleStepEvent","stepMouseover"),'" ');
a.push('onmouseout\x3d"',this.fireCode("_handleStepEvent","stepMouseout"),'" ');a.push('class\x3d"sfStepsChartStep ',c,f,'"\x3e');this._stepIcon?(a.push('\x3cdiv id\x3d"',this.id,'stepIconDesc" class\x3d"hiddenAriaContent"\x3e',this._stepName,"\x3c/div\x3e"),a.push('\x3cspan aria-describedby\x3d"',this.id,'stepIconDesc" title\x3d"',this._stepName,'" class\x3d"sfStepsChartIcon ',this._stepIcon,'"\x3e\x3c/span\x3e')):a.push("\x3cspan\x3e",this._data.stepOrder+1,"\x3c/span\x3e");(this._completed||this._isIC)&&
a.push('\x3cdiv class\x3d"sfStepsChartStatusIcon ',d,'"\x3e\x3c/div\x3e');a.push("\x3c/div\x3e")},_handleStepEvent:function(a){this.dispatch(a,{step:this})},renderHtml:function(a){var b="sfStepsChartStepItem";this._currentStep&&(b+=" sfStepsChartSelected");a.push('\x3cli class\x3d"',b,'"\x3e');this._renderStepCircle(a,this._currentStep?SFStepsChart.GLOBAL_PRIMARY_BUTTON:"globalSecondaryElement");this._stepName&&!this._hideStepName&&(a.push('\x3cdiv class\x3d"sfStepsChartStepContainer"\x3e'),this._currentStep&&
this._dueDate&&(a.push('\x3cdiv id\x3d"',this.id,'_dueDate" class\x3d"sfStepsChartDueDate',this._overDue?" globalPortletAlertTextColor":"",'"\x3e'),a.push(MSGS.COMMON_STEPSCHART_DUE_ON.replace("{0}",this._dueDate)),a.push("\x3c/div\x3e")),b=juic.escapeHTML(this._stageName)+": "+juic.escapeHTML(this._stepName),a.push('\x3cdiv class\x3d"sfStepsChartNameContainer"\x3e'),a.push('\x3cdiv id\x3d"',this.id,'_stepsChartStep" class\x3d"sfStepsChartStepHolder sfStepsChartDisplayInlineBlock ',this._currentStep?
"sfStepsChartCurrentStep":"",'"\x3e'),a.push('\x3cdiv id\x3d"',this.id,'_stepLabelledBy" class\x3d"hiddenAriaContent"\x3e',b,"\x3c/div\x3e"),a.push('\x3cdiv id\x3d"',this.id,'_stepsChartStepName" class\x3d"sfStepsChartStepName" title\x3d"',b,'" aria-labelledby\x3d"',this.id,'_stepLabelledBy"\x3e'),a.push(juic.escapeHTML(this._stepName)),a.push("\x3c/div\x3e"),a.push("\x3c/div\x3e"),a.push("\x3c/div\x3e"),this._renderActionIcon(a),a.push("\x3c/div\x3e"),this._renderInfoIcon(a));a.push('\x3cdiv class\x3d"sfStepsChartHighlight ',
SFStepsChart.GLOBAL_PRIMARY_BUTTON,'"\x3e\x3c/div\x3e');a.push("\x3c/li\x3e");a.addAfterRenderListener(this,"_setEllipsis")},_renderInfoIcon:function(a){this._showInfoIcon&&(a.push('\x3cdiv id\x3d"',this.id,'_infoDescribedBy" class\x3d"hiddenAriaContent"\x3e',MSGS.COMMON_STEPSCHART_INFO_DESCRIPTION,"\x3c/div\x3e"),a.push("\x3cbutton "),a.push('title\x3d"',MSGS.COMMON_STEPSCHART_INFO_DESCRIPTION,'" '),a.push('type\x3d"button" '),a.push('aria-describedby\x3d"',this.id,'_infoDescribedBy" '),a.push('id\x3d"routMapInfoIcon',
this.id,'" class\x3d"sfStepsChartInfoIcon" '),a.push('onclick\x3d"',this.fireCode("_onClickInfo",{step:this._data,infoId:"routMapInfoIcon"+this.id}),'"\x3e\x3c/button\x3e'))},_onClickInfo:function(a){this.dispatch("stepInfoClick",a)},_renderActionIcon:function(a){this._currentStep&&this._actionList&&(a.push('\x3cdiv id\x3d"',this.id,'_actionDescribedBy" class\x3d"hiddenAriaContent"\x3e',MSGS.COMMON_STEPSCHART_ACTION_DESCRIPTION,"\x3c/div\x3e"),a.push('\x3cdiv class\x3d"sfStepsChartActionContainer globalHighlightTextInversed"\x3e'),
a.push("\x3ca "),a.push('aria-describedby\x3d"',this.id,'_actionDescribedBy" '),a.push('href\x3d"javascript:void(0);" '),a.push('id\x3d"routMapActionIcon',this.id,'" '),a.push('class\x3d"sfStepsChartActionIcon" '),a.push('onclick\x3d"',this.fireCode("_showActions","routMapActionIcon"+this.id),'"\x3e'),a.push('\x3cspan class\x3d"sfStepsChartActionIconContainer"\x3e'),a.push("\x3c/span\x3e"),a.push("\x3cspan\x3e"),a.push(MSGS.COMMON_STEPSCHART_ACTIONS),a.push("\x3c/span\x3e"),a.push("\x3c/a\x3e"),a.push("\x3c/div\x3e"))},
_setEllipsis:function(a){a=juic.$(this.id+"_stepsChartStep");var b=juic.$(this.id+"_stepsChartStepName");a&&a.scrollHeight>a.clientHeight&&SFDom.addClass(a,"sfStepsChartMultiLine");SFDom.addClass(b,"sfStepsChartStepNamePosition")},_showActions:function(a,b){this._dropMenuPopup=new SFDropMenuPopup(this._actionList,{animate:!0,closeOnMouseout:!1,closeDialogOnEsc:!0,useNameAnchor:!0,showCloseIcon:!1,clickOutsideClosesPopup:!0,refocusId:a,css:"sfStepsChartActionPopover",escapeHTML:!0});this._dropMenuPopup.addEventListener("action",
this,"handleActionEvent");this._dropMenuPopup.show(a)},_showDescription:function(a){if(!this._descPopUp){var b=new SFSpan(this._desc);b.setCSSClass("sfStepsChartDescription sfStepsChartDisplayInlineBlock");this._descPopUp=new SFCalloutPopup({closeOnMouseout:!1,content:b,originOptions:{pointerOffset:15,flipPointerOffset:!0}})}this._descPopUp.show(this.id+"_description",{});SFDOMEvent.stopPropagation(a)},_showWorkflowButtons:function(){this._dropMenuPopup&&this._dropMenuPopup.show(this.id+"_stepsChartStepName")},
isCurrentStep:function(){return this._currentStep},getDomId:function(){return this.id+"_step"},getStepOrder:function(){return this._data.stepOrder},setComplete:function(){var a=juic.$(this.getDomId());a&&(this._currentStep=!1,this._completed=!0,Util.removeClass(a,"sfCurrentStep"),Util.addClass(a,"sfCompletedStep"))},handleActionEvent:function(a){switch(a.actionCommand){case "menuItemClicked":this.dispatch("menuItemClicked",{button:a.menuItem.workFlowButtonVO,evt:a})}}})})();
function SFStepsChartSeparator(a,b,c){this.register();this._init(a,b,c)}
(function(){juic.extend(SFStepsChartSeparator,juic.Component,{_init:function(a,b,c){this._isList=!!a;this._active=b||!1;this._stepName=c},renderHtml:function(a){var b=this._active?SFStepsChart.GLOBAL_PRIMARY_BUTTON:"";this._isList?(a.push('\x3cli class\x3d"sfStepsChartSeparatorContainer"\x3e'),a.push('\x3chr class\x3d"sfStepsChartSeparator '),this._stepName||a.push("sfStepsChartSeparatorNoStepName "),a.push("sfStepsChartDisplayInlineBlock ",b,'"\x3e\x3c/hr\x3e'),a.push("\x3c/li\x3e")):a.push('\x3chr class\x3d"sfStepsChartSeparator sfStepsChartStageSeparator sfStepsChartDisplayInlineBlock ',
b,'"\x3e\x3c/hr\x3e')}})})();