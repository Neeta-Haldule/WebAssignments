function ObjectiveSection(a,b){this.register();this.init(a,b)}
(function(){extend(ObjectiveSection,PM2BaseSection,{init:function(a,b){this.itemComps=[];this.m=a;this.dataPath="/"+b;this.sectionData=this.m.getData(this.dataPath);this.weightSymbol=PMSectionUtils.buildWeightSymbol(window.formConfig,this.sectionData);this._buildObjCategoriesParam();this.itemComps.push(this._buildSectCaption());this.itemComps=this.itemComps.concat(this._buildItems());var c=PMSectionUtils.buildSectComment(this.m,this.dataPath,this.sectionData);c&&this.itemComps.push(c)},_buildSectCaption:function(){var a=
null!=this.sectionData.sectDesc&&""!==this.sectionData.sectDesc.trim()?new PM2SectionCaption(this.m,this.dataPath):null,b=[];this.sectionData.addItemEnabled&&b.push({actionCommand:"addNewGoal",css:"addNewGoal",label:'\x3cspan class\x3d"goalActionTitle"\x3e'+MSGS.PERFORMANCE_PM2_ADD_NEW_GOAL_TITLE+'\x3c/span\x3e\x3cspan class\x3d"goalActionDesc"\x3e'+MSGS.PERFORMANCE_PM2_ADD_NEW_GOAL_DESC+"\x3c/span\x3e"});this.sectionData.smartWizardEnabled&&b.push({actionCommand:"addWizardGoal",css:"addWizardGoal",
label:'\x3cspan class\x3d"goalActionTitle"\x3e'+MSGS.PERFORMANCE_PM2_ADD_GOAL_BY_WIZARD_TITLE+'\x3c/span\x3e\x3cspan class\x3d"goalActionDesc"\x3e'+MSGS.PERFORMANCE_PM2_ADD_GOAL_BY_WIZARD_DESC+"\x3c/span\x3e"});if(this.sectionData.addExistingObjEnabled){var c=window.formConfig.subject;b.push({actionCommand:"addExistingGoal",css:"addExistingGoal",label:'\x3cspan class\x3d"goalActionTitle"\x3e'+sfMessageFormat.format(MSGS.PERFORMANCE_PM2_ADD_EXISTING_GOAL_TITLE,c.firstName)+'\x3c/span\x3e\x3cspan class\x3d"goalActionDesc"\x3e'+
sfMessageFormat.format(MSGS.PERFORMANCE_PM2_ADD_EXISTING_GOAL_DESC,c.firstName)+"\x3c/span\x3e"})}this.linkComponent=1==b.length?new PMIconTextLink("\x26#xe058;",MSGS.PERFORMANCE_PM2_ADD_NEW_GOAL_TITLE,b[0].actionCommand):new SFDropMenu(b,{css:"globalPlacematLink pmIconTextLink rightLink",content:new PMIconText("\x26#xe058;",MSGS.PERFORMANCE_PM2_ADD_NEW_GOAL_TITLE)});this.linkComponent.addEventListener("action",this);this._sectionTopBar=new PM2SectionTopBar(this.m,this.dataPath,"goal");this._sectionTopBar.setLinkComponent(this.linkComponent);
this._sectionTopBar.addEventListener("editSectWeights",this);this._sectionTopBar.addEventListener("pm2SectionTopBarRendered",this);return this._objectivesSecCaptionSlots=new PMPortlet(a,this._sectionTopBar,!0)},_buildItems:function(){var a=PMSectionUtils.buildCommonSectionConfig(window.formConfig,this.sectionData);a.isMLT=!1;a.isAutoPopWeights=this.sectionData.autoPopWeights;a.groupLabel=this.sectionData.groupLabel;a.groupPerm=this.sectionData.groupPerm;a.groupList=this.sectionData.groupList;a.isShowRatingHelpIcon=
this.sectionData.showRatingHelpIcon;for(var b=[],c=this.sectionData.sectItems,d=0;d<c.length;d++){var e=this.dataPath+"/sectItems/"+d,e=a.ezRaterEnabled?new PMObjectiveItemEZRater(this.m,e,a):new PMObjectiveItemNormal(this.m,e,a);e.addEventListener("editWeights",this);e.addEventListener("editGoal",this);e.addEventListener("itemSelected",this);b.push(e)}c=this.dataPath+"/ratingScale";return a.ezRaterEnabled?PMSectionUtils.buildEZRater(this.sectionData,b,{ratingScale:{m:this.m,path:c}}):b},_buildObjCategoriesParam:function(){if(this.sectionData.objCategories&&
0<this.sectionData.objCategories.length){this.objCategoriesParam="\x26ccount\x3d"+this.sectionData.objCategories.length;for(var a=0,b=this.sectionData.objCategories.length;a<b;a++)this.objCategoriesParam+="\x26c"+a+"\x3d"+encodeURIComponent(this.sectionData.objCategories[a])}},_submitForm:function(){PMUSaveUtils.submitForm()},refreshItemWeights:function(){for(var a=0,b=this.itemComps.length;a<b;a++){var c=this.itemComps[a];if("undefined"!=typeof c.refreshWeights&&c.dataPath){var d=this.m.getData(c.dataPath+
"/itemWeight");c.refreshWeights(d)}}},_editWeights:function(a){this.pm2EditWeight||(this.pm2EditWeight=new PM2EditWeight(this.m,a.dataPath,{title:MSGS.PERFORMANCE_PM2_EDIT_GOAL_WEIGHTS,sectionName:this.sectionData.sectName,weightTotal:this.sectionData.weightTotal,weightTotalOption:this.sectionData.weightTotalOption,weightSymbol:this.weightSymbol}),this.pm2EditWeight.addEventListener("saveWeights",this));this.pm2EditWeight.show(a.triggerElId)},_editSectWeights:function(a){PM2BaseSection.prototype.editInSummarySectWeights.apply(this,
arguments)},renderHtml:function(a){for(var b=0;b<this.itemComps.length;b++)this.itemComps[b].renderHtml(a)},getSectionTitle:function(){return this._sectionTopBar.getSectionTitle()},getFocusId:function(){return this._objectivesSecCaptionSlots.getFocussableAnchor()},handleEvent:function(a){switch(a.type){case "action":"addNewGoal"==a.actionCommand?window.open("/tgmEdit?t\x3d"+this.sectionData.objPlanId+"\x26excPri\x3d"+this.sectionData.excludePrivateGoal+"\x26u\x3d"+formConfig.subject.userId+"\x26f\x3d"+
formConfig.folderMapId+"\x26d\x3d-1\x26s\x3d"+this.sectionData.sectIndex+"\x26fsid\x3d"+formConfig.subject.userId+"\x26origin\x3df"+(this.objCategoriesParam?this.objCategoriesParam:"")+"\x26feid\x3d"+this.sectionData.elementId+"\x26frompm2\x3d1","add","height\x3d540,width\x3d700,dependent\x3dyes,resizable\x3dyes,hotkeys\x3dno"):"addWizardGoal"==a.actionCommand?window.open("/smartEdit?t\x3d"+this.sectionData.objPlanId+"\x26u\x3d"+formConfig.subject.userId+"\x26f\x3d"+formConfig.folderMapId+"\x26d\x3d-1\x26s\x3d"+
this.sectionData.sectIndex+"\x26feid\x3d"+this.sectionData.elementId+(this.objCategoriesParam?this.objCategoriesParam:"")+"\x26frompm2\x3d1","add","height\x3d540,width\x3d700,dependent\x3dyes,resizable\x3dyes,hotkeys\x3dno"):"addExistingGoal"==a.actionCommand&&window.open("/acme?fbacme_o\x3dmy_forms\x26inbox_os\x3dworkflow\x26wf_sect_"+this.sectionData.sectIndex+"_addo4btn\x3dAdd Existing Objective\x26inbox_fmid\x3d"+formConfig.folderMapId+"\x26excPri\x3d"+this.sectionData.excludePrivateGoal+(this.objCategoriesParam?
this.objCategoriesParam:"")+"\x26frompm2\x3d1","add","height\x3d540,width\x3d700,dependent\x3dyes,resizable\x3dyes,hotkeys\x3dno,scrollbars\x3dyes");break;case "editGoal":PM2DialogUtil.stopEvent(a);window.open("/tgmEdit?t\x3d"+this.sectionData.objPlanId+"\x26excPri\x3d"+this.sectionData.excludePrivateGoal+"\x26u\x3d"+formConfig.subject.userId+"\x26f\x3d"+formConfig.folderMapId+"\x26d\x3d-1\x26s\x3d"+this.sectionData.sectIndex+"\x26fsid\x3d"+formConfig.subject.userId+"\x26g\x3d"+a.itemId+"\x26origin\x3df"+
(this.objCategoriesParam?this.objCategoriesParam:"")+"\x26frompm2\x3d1","edit","height\x3d540,width\x3d700,dependent\x3dyes,resizable\x3dyes,hotkeys\x3dno");break;case "editWeights":this._editWeights(a);break;case "editSectWeights":this._editSectWeights(a);break;case "saveWeights":var b=a.weights;if(b){for(var c=0,d=b.length;c<d;c++)this.m.setData(a.dataPath+"/"+c+"/itemWeightVO/value",b[c].weight);PMUSaveUtils.autoSaveForm()}break;case "pm2SectionTopBarRendered":this.linkComponent instanceof SFSimpleLink&&
SFDom.addClass(this.linkComponent.getReferenceId(),"globalPlacematLink pmDropMenuLink addNewObjectiveGoal")}}})})();function PMObjectiveItemBase(a,b,c){this.register();this._init(a,b,c)}
(function(){extend(PMObjectiveItemBase,BaseItem,{_init:function(a,b,c){this._m=a;this.dataPath=b;this._obj=this._m.getData(b);this.sectionIndex=PMPathUtil.getSectionIndex(b);this.itemId=this._obj.itemId;this.ezRaterEnabled=c.ezRaterEnabled;this.weightSymbol=c.weightSymbol;if(this._weight=PMSectionUtils.buildItemWeight(this._obj.itemWeightVO,c.itemWeightRequired,c.weightSymbol,c.isAutoPopWeights))this._weight.bindProperty(this._m,this.dataPath+"/itemWeightVO/value"),this._weight.addEventListener("editWeights",
this);c.isMLT=!!this._obj.mltRatingPresent;c.mltRating=this._obj.mltRating||"";this.formConf=c;this._buildRatingComments();this._supportData=new PM2SupportData(this._m,this.dataPath,c.ratingScale,{isMLT:c.isMLT,ezRaterEnabled:c.ezRaterEnabled,ratingOption:c.ratingOption,subject:c.subject},!1);void 0!=this._m.getData(this.dataPath+"/othersRatingComments")&&(this._othersRatings=new OthersRating(this._m,this.dataPath,c.ratingScale,{isMLT:c.isMLT,ezRaterEnabled:c.ezRaterEnabled,ratingOption:c.ratingOption,
subject:c.subject,isExpanded:!0,isShowRatingHelpIcon:c.isShowRatingHelpIcon}));this.customElements=PMSectionUtils.buildCustomElements(this._m,this.dataPath+"/customElements",this.formConf)},getFocussableAnchor:function(){return"anchor_"+this.sectionIndex+"_"+this.itemId},_buildRatingComments:function(){this._formFactory=new FormFactory(this._m,this.dataPath,this.formConf);var a=this._formFactory.generateFormMeta();this.formComps=this._formFactory.generateForm(a);for(var a=0,b=this.formComps.length;a<
b;a++)PMSectionUtils.registerFormCompEvent(this.formComps[a],this)},renderHtml:function(a){this._super(a)},_renderAnchor:function(a){a.push('\x3ca href\x3d"#" onclick\x3d"return false;" class\x3d"anchor_rel" id\x3d"',this.getFocussableAnchor(),'" name\x3d"',this.getFocussableAnchor(),'"');a.push(' aria-hidden\x3d"true" title\x3d"',juic.escapeHTML(this._obj.itemName),'"\x3e\x26nbsp;\x3c/a\x3e')},_renderWeightState:function(a){a.push('\x3cdiv class\x3d"pm2RFloatBlock"\x3e');this._weight&&(a.push('\x3cp class\x3d"pm2Weight"\x3e'),
this._weight.renderHtml(a),a.push("\x3c/p\x3e"));this._obj.objState&&(a.push('\x3cdiv class\x3d"pm2Status"\x3e'),a.push('\x3cdiv tabindex\x3d"0" class\x3d"globalRoundedCorners pm2StatusLegend" style\x3d"',juic.escapeHTML(this._obj.objState.style),'"\x3e'),a.push(juic.escapeHTML(this._obj.objState.name)),a.push("\x3c/div\x3e"),a.push("\x3c/div\x3e"));a.push("\x3c/div\x3e")},_renderCustomContent:function(a){PMSectionUtils.renderGroup(a,this._obj,this.formConf,this);this.customElements&&(a.push('\x3cdiv class\x3d"pmItemDesc"\x3e'),
this.customElements.renderHtml(a),a.push("\x3c/div\x3e"))},_onGroupChange:function(){PMUSaveUtils.autoSaveForm()},_renderMainContent:function(a){a.push('\x3cdiv class\x3d"pmContainer"\x3e');a.push('\x3cdiv class\x3d"pm2LFloatBlock pm2ReviewInfo"\x3e');if(this.formComps)for(var b=this._obj.mltRatingPresent&&this._obj.mltObjTemplateName?this._obj.mltObjTemplateName:void 0,c=0,d=this.formComps.length;c<d;c++)PMSectionUtils.renderRatingComment(a,this.formComps[c],b);a.push("\x3c/div\x3e");void 0!=this._othersRatings&&
(a.push('\x3cdiv class\x3d"pm2RFloatBlock pm2SupportData"\x3e'),a.push('\x3cdiv class\x3d"tabTitle"\x3e',MSGS.PERFORMANCE_REVIEW_OTHERS_RATING,"\x3c/div\x3e"),this._othersRatings.renderHtml(a),a.push("\x3c/div\x3e"));a.push("\x3c/div\x3e");this._supportData.renderHtml(a)},_editItem:function(a){this.dispatch("editGoal",{itemId:this.itemId})},refreshWeights:function(a){this._weight&&this._weight.refresh(a)},_handleRateSelected:function(a){},_submitForm:function(){PMUSaveUtils.submitForm()},handleEvent:function(a){switch(a.type){case "editWeights":a.dataPath=
this.dataPath.substring(0,this.dataPath.lastIndexOf("/"));this.dispatch(a.type,a);break;case "change":this._handleValidation(a.target);break;case "rateSelected":this._handleValidation(a.target),this._handleRateSelected(a.target)}},_handleValidation:function(a){var b=PMValidationUtil.validate(a);b.result?PMValidationUtil.clearFieldError(a.id):PMValidationUtil.insertFieldError(a.id,b.message)},_deleteItem:function(){if(confirm(MSGS.Delete_Confirmation_From_Form)){window.setFormModifiedFlagTrue&&window.setFormModifiedFlagTrue();
var a=juic.$("hiddenSubmit");a&&(a.name=this._obj.deleteButtonKey,a.value="Remove",a.click())}}})})();function PMObjectiveItemNormal(a,b,c){this.register();this._init(a,b,c)}
(function(){extend(PMObjectiveItemNormal,PMObjectiveItemBase,{_init:function(a,b,c){this._super(a,b,c)},renderHtml:function(a){this._super(a)},_handleEditSpanBtnKeyPress:function(a){var b=SFDOMEvent.getCharCode(a);if(b==SFDOMEvent.KEY_CODE.RETURN||b===SFDOMEvent.KEY_CODE.SPACE)a.preventDefault(),this._editItem(a)},_handleDeleteSpanBtnKeyPress:function(a){var b=SFDOMEvent.getCharCode(a);if(b==SFDOMEvent.KEY_CODE.RETURN||b===SFDOMEvent.KEY_CODE.SPACE)a.preventDefault(),this._deleteItem(a)},renderBody:function(a){a.push('\x3cdiv id \x3d "',
this.id,'" class\x3d"" \x3e');a.push('\x3cdiv class\x3d"pm2ObjectItemHeader" \x3e');a.push('\x3cdiv class\x3d"pm2LFloatBlock"\x3e');a.push('\x3cdiv class\x3d"pm2LTitleBlockWithActionLinks"\x3e');this._renderAnchor(a);this._obj.itemCategory&&a.push('\x3cp class\x3d"pmItemCategory"\x3e',juic.escapeHTML(this._obj.itemCategory),"\x3c/p\x3e");this._obj.deleted&&a.push('\x3cp class\x3d"pmItemGoalDeleted globalPortletAlertTextColor"\x3e',MSGS.PERFORMANCE_PM2_GOAL_DELETED_FROM_PLAN_MSG,"\x3c/p\x3e");a.push('\x3ch3 class\x3d"pmItemName"\x3e\x3cspan id\x3d"',
this.itemId,'-name"\x3e',this._obj.objectiveNumber?juic.escapeHTML(this._obj.objectiveNumber)+" ":"",juic.escapeHTML(this._obj.itemName,"\x3c/br\x3e"),"\x3c/span\x3e\x3c/h3\x3e");if(this._obj.editable||this._obj.removable)a.push('\x3cspan class\x3d"actionLinks"\x3e'),this._obj.editable&&(a.push('\x3cspan tabIndex\x3d0 class\x3d"sapIcon" role\x3d"button" onKeyPress\x3d"',this.fireCode("_handleEditSpanBtnKeyPress"),'" onclick\x3d"',this.fireCode("_editItem"),' return false;"'),a.push(' aria-label\x3d"',
juic.escapeHTML(MSGS.get("PERFORMANCE_PM2_EDIT_GOAL_BY_NAME",this._obj.itemName)),'"'),a.push(' title\x3d"',juic.escapeHTML(MSGS.get("PERFORMANCE_PM2_EDIT_GOAL_BY_NAME",this._obj.itemName)),'"\x3e\x26#xe038;\x3c/span\x3e')),this._obj.removable&&(a.push('\x3cspan tabIndex\x3d0 class\x3d"sapIcon" role\x3d"button" onKeyPress\x3d"',this.fireCode("_handleDeleteSpanBtnKeyPress"),'" onclick\x3d"',this.fireCode("_deleteItem"),' return false;"'),a.push(' aria-label\x3d"',juic.escapeHTML(MSGS.get("PERFORMANCE_PM2_DELETE_GOAL_BY_NAME",
this._obj.itemName)),'"'),a.push(' title\x3d"',juic.escapeHTML(MSGS.get("PERFORMANCE_PM2_DELETE_GOAL_BY_NAME",this._obj.itemName)),'"\x3e\x26#xe03d;\x3c/span\x3e')),a.push("\x3c/span\x3e");a.push("\x3c/div\x3e");a.push('\x3cp class\x3d"pmItemDesc"\x3e',juic.escapeHTML(this._obj.objMetric,"\x3c/br\x3e"),"\x3c/p\x3e");a.push("\x3c/div\x3e");this._renderWeightState(a);a.push("\x3c/div\x3e");this._renderCustomContent(a);this._renderMainContent(a);a.push("\x3c/div\x3e")}})})();
function PMObjectiveItemEZRater(a,b,c){this.register();this._init(a,b,c)}
(function(){extend(PMObjectiveItemEZRater,PMObjectiveItemBase,{_init:function(a,b,c){this._guid2ezdata={};this._guid2comp={};this._comp2guid={};this._raterContentDomIds=[];this._raterDomId2IconDomId={};this._super(a,b,c);this._buildItemEZRaterData()},_buildItemEZRaterData:function(){this._itemData={guid:this.id+"guid_"+this._obj.itemId,itemName:this._obj.itemName,itemDesc:"",removable:this._obj.removable,editable:this._obj.editable,anchor:this.getFocussableAnchor()};var a=PMSectionUtils.buildManagerSubjectRating(this.dataPath,
this._formFactory,this.formConf,this._obj.othersRatingComments,3==this.formConf.ratingOption);a.managerRating&&(this._itemData.managerRating=a.managerRating);a.subjectRating&&(this._itemData.subjectRating=a.subjectRating);this._itemData.gapScaleValues=PMSectionUtils.buildGapScaleValues(this.formConf.ratingScale?this.formConf.ratingScale.scaleValues:[]);this._guid2ezdata[this._itemData.guid]=this._itemData},_renderItemContent:function(a){this._raterContentDomIds.push(this._itemData.guid+"_content");
a.push('\x3ctr id\x3d"',this._itemData.guid+"_content",'" class\x3d"',this._ezConfig.expandAll?"expanded":"collapsed",'"\x3e');a.push('\x3ctd class\x3d"itemContent ',this._getContentBottomBorderClzName(),'" colspan\x3d"',this._ezConfig.columnsCount,'"\x3e');a.push('\x3cdiv class\x3d"pm2ObjectItemHeader" \x3e');a.push('\x3cdiv class\x3d"pm2LFloatBlock"\x3e');a.push('\x3cdiv class\x3d"pm2LTitleBlockWithActionLinks"\x3e');this._obj.itemCategory&&a.push('\x3cp class\x3d"pmItemCategory"\x3e',juic.escapeHTML(this._obj.itemCategory),
"\x3c/p\x3e");this._obj.deleted&&a.push('\x3cp class\x3d"pmItemGoalDeleted globalPortletAlertTextColor"\x3e',MSGS.PERFORMANCE_PM2_GOAL_DELETED_FROM_PLAN_MSG,"\x3c/p\x3e");a.push("\x3c/div\x3e");a.push('\x3cp class\x3d"pmItemDesc"\x3e',juic.escapeHTML(this._obj.objMetric,"\x3c/br\x3e"),"\x3c/p\x3e");a.push("\x3c/div\x3e");this._renderWeightState(a);a.push("\x3c/div\x3e");this._renderCustomContent(a);this._renderMainContent(a);a.push("\x3c/td\x3e\x3c/tr\x3e")},_getContentBottomBorderClzName:function(){return!this._isLastItem},
renderHtml:function(a){var b=PMSectionUtils.hasItemContent(this._obj,this.formConf,this.formComps);PMSectionUtils.renderEZRater(a,this._itemData,{isBehavior:!1,ezConfig:this._ezConfig,expandable:b},this);b&&this._renderItemContent(a)},setEzConfig:function(a){this._ezConfig=a},setIsLastItem:function(a){this._isLastItem=a},hasManagerRating:function(){return!!this._itemData.managerRating},hasSubjectRating:function(){return!!this._itemData.subjectRating},hasAction:function(){return this._itemData.removable||
this._itemData.editable},_handleRateSelected:function(a){this._updateGapImage(this._comp2guid[a.id])},_updateGapImage:function(a){PMSectionUtils.updateGapImage(this._guid2ezdata[a],this._guid2comp["img_"+a])},toggle:function(a){PMSectionUtils.expandCollapseAllEZRaterItems(this._raterContentDomIds,this._raterDomId2IconDomId,a)},_toggleItem:function(a){PMSectionUtils.toggleEZRaterItem(a,this._raterContentDomIds,this._raterDomId2IconDomId)}})})();